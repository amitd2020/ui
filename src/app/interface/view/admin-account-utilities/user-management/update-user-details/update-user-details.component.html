<p-messages [value]="msgs"></p-messages>

<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle" [key]="'update-user-details'" appendTo="body"></p-confirmDialog>

<div class="card p-4">

	<div class="flex justify-content-between">

		<div ><button pButton label="Back" icon="ui-icon-arrow-back" iconPos="left" class="p-button-sm p-button-secondary" (click)="goBack()"></button></div>

		<ng-container *ngIf=" ( userAuthService.hasRolePermission( ['Super Admin'] ) && this.userManagementRowData['isMultipleDeviceLogin'] == true )">

			<div class="infoName roundedColoredChipLabel c-green" (mouseover)="showCompanyQuickInfoPopover($event, userManagementRowData)" (mouseout)="hideCompanyQuickInfoPopover()">
				Logged Devices: {{ this.userManagementRowData['noOfLoginDevices'] }}			
			</div>

		</ng-container>

	</div>

	<ng-container *ngIf="!userAuthService.hasRolePermission( ['Client Admin'] ) && userRoleFinal == 'Client Admin Master' && !corporateUserEditView">

		<div class="card onlyLinesAround">
			<div class="grid align-items-center">
	
				<div class="col">
					<div class="c-darkBlue text-3xl font-normal">{{ userManagementRowData?.companyName }}</div>
				</div>
	
				<div class="col-fixed text-right">
					<ng-container *ngIf="userDetails">
						<ng-container *ngIf="userDetails.total > 0; else zeroTotalUser">
							<h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-green': userDetails.total > 0 }"> Total Users: <strong>{{ userDetails.total | number }}</strong> </h3>
						</ng-container>
						<ng-template #zeroTotalUser>
							<h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-green': userDetails.total > 0 }"> Total Users: <strong>{{ userDetails.total | number }}</strong> </h3>
						</ng-template>
					</ng-container>
				</div>
	
			</div>
	
			<div class="grid mt-2 align-items-center">
				<div class="col-fixed">
					<div class="heading-font">Subscription End Date:</div>
				</div>
				<div class="col-fixed">
					<p-calendar #subscription_EndDate name="subs_endDate" [(ngModel)]="userManagementRowData.subs_endDate" hideOnDateTimeSelect="true" [showIcon]="true" [numberOfMonths]="1" [monthNavigator]="true" icon="pi pi-pencil" [yearNavigator]="true" yearRange="2000:2030" dateFormat="dd-mm-yy" [readonlyInput]="true" appendTo="body" [baseZIndex]="999999998" styleClass="calenderStyle"></p-calendar>
				</div>
				<div class="col-fixed">
					<div class="heading-font">Post Code:</div>
				</div>
				<div class="col-fixed">
					<span class="p-float-label">
						<input type="text" pInputText name="postalCode" [(ngModel)]="userManagementRowData.postalCode" style="padding-top: 0;">
					</span>
				</div>
			</div>
	
		</div>

	</ng-container>

	<p-accordion [multiple]="true" styleClass="onlyLinesAround">

		<ng-container *ngIf="userManagementRowData?.userRole != 'Client Admin Master' || userAuthService.hasRolePermission( ['Client Admin'] ) || corporateUserEditView">

			<p-accordionTab header="User Info" [selected]="true">
	
				<div class="grid p-3 p-fluid">
	
					<div class="col-12 md:col-6 lg:col-4">
						<span class="p-float-label">
							<input type="text" pInputText name="username" [(ngModel)]="userManagementRowData.username">
							<label for="username">Username</label>
						</span>
					</div>
					
					<div class="col-12 md:col-6 lg:col-4">
						<span class="p-float-label">
							<input type="text" pInputText name="email" [(ngModel)]="userManagementRowData.email" disabled>
							<label>Email</label>
						</span>
					</div>

					<div class="col-12 md:col-6 lg:col-4" *ngIf="showCompanyNameFieldSuggestion && userAuthService.hasRolePermission( ['Super Admin'] )">
						<span class="p-float-label">
							<p-autoComplete name="companyName" [suggestions]="filteredCompanyNameArray" (completeMethod)="filteredCompanyName($event)" (onSelect)="onSelectCompany($event)" field="companyName"  [minLength]="0" #companyName="ngModel" ngModel ></p-autoComplete>
							<label>Company Name</label>
							<span *ngIf="fieldValidate">
								<small style="float: left;">
									Company Name is mandatory
								</small>
							</span>
						</span>
					</div>

					<div class="col-12 md:col-6 lg:col-4" *ngIf="userManagementRowData?.userRole && !['Client Admin', 'Client User'].includes(userManagementRowData?.userRole) && !corporateUserEditView && !( userAuthService.hasRolePermission( ['Client Admin'] ) && [ 'Client Admin Master' ].includes(userManagementRowData?.userRole) )">
						<span class="p-float-label">
							<p-calendar #subscription_EndDate name="subs_endDate" [(ngModel)]="userManagementRowData.subs_endDate" hideOnDateTimeSelect="true" [showIcon]="true" [numberOfMonths]="1" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030" dateFormat="dd-mm-yy" [readonlyInput]="true" appendTo="body" [baseZIndex]="999999998"></p-calendar>
							<label>Subscription End Date</label>
						</span>
					</div>

					<ng-container *ngIf="( [ subscribedPlanModal['Monthly_Enterprise'], subscribedPlanModal['Enterprise_Annual_One_Year'], subscribedPlanModal['Enterprise_Annual_Two_Year'], subscribedPlanModal['Enterprise_New_Monthly'], subscribedPlanModal['Monthly_Enterprise_Paid_Test'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Monthly_Enterprise_Trial'], subscribedPlanModal['Annually_Enterprise'], subscribedPlanModal['Annually_Enterprise_Trial'], subscribedPlanModal['Enterprise_Conversion_For_Ravi'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Enterprise_Weekly_Trial'], this.subscribedPlanModal['Premium_New_Monthly'], this.subscribedPlanModal['Premium_Annual_One_Year'], this.subscribedPlanModal['Premium_Annual_Two_Year'] ].includes( currentPlanForUser ) )">
						<div class="col-12 md:col-6 lg:col-4 align-self-end">
							<div class="grid">
								<div class="col-fixed">
									<label>Client Admin</label>
								</div>
								<div class="col-fixed">
									<ng-container *ngIf="[ 'Client Admin Master', 'Client Admin' ].includes( userRoleFinal ); else showSwitchToggleButton">
										<i class="material-icons c-green">check_circle</i>
									</ng-container>
									<ng-template #showSwitchToggleButton>
										<p-inputSwitch name="clientAdmin" [(ngModel)]="clientAdminChangeBoolean" (onChange)="checkforCompanyNameExist($event)"></p-inputSwitch>
									</ng-template>
								</div>
							</div>
						</div>
	
					</ng-container>
	
					<ng-container *ngIf="[ 'Client User' ].includes( userRoleFinal ) || ( userAuthService.hasRolePermission( ['Super Admin'] ) && [ 'Client User' ].includes( userRoleFinal ) )">
						
						<div class="col-12 md:col-6 lg:col-4">
							<span class="p-float-label">
								<p-dropdown name="teamId" [(ngModel)]="selectedTeamId" [options]="clientTeamList" optionLabel="name" optionValue="_id"  [baseZIndex]="999999998" appendTo="body" (onChange)="checkIfTeamSelected( $event )" required styleClass="listOfTeamsStyle">
                                    <ng-template let-user pTemplate="item">
                                        {{ user.name | titlecase }}
                                    </ng-template>
                                </p-dropdown>
								<label>Team</label>
								<span *ngIf="clientTeamList.length == 1" class="c-red">
									<small>Please <a href="javascript:void(0);" [routerLink]="'/user-management/team-management'" class="c-green"><u>click here</u></a> and create team first</small>
								</span>
							</span>
						</div>
	
					</ng-container>
	
				</div>
	
			</p-accordionTab>

		</ng-container>

		<ng-container *ngIf="!corporateUserEditView">

			<p-accordionTab header="{{ userAuthService.hasRolePermission( ['Client Admin'] ) || userAuthService.hasRolePermission( ['Client Admin Master'] ) ? 'Available Limits' : 'User Limits' }}" [selected]="true" *ngIf="userRoleFinal && ( userAuthService.hasRolePermission( ['Super Admin'] ) && !['Client Admin', 'Client User'].includes( userRoleFinal ) ) || ( ( userAuthService.hasRolePermission( ['Client Admin'] ) || userAuthService.hasRolePermission( ['Client Admin Master'] ) ) && !['Client User'].includes( userRoleFinal ) )">
	
				<div class="grid p-3 p-fluid">
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="advancedLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.advancedLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Export</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Export Limit: {{ userManagementRowData.advancedLimit | number : '1.0-0'}}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="corpLandLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.corpLandLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Land Corporate</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Land Corporate Limit: {{ userManagementRowData.corpLandLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="landLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.landLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Land Registry</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Land Registry Limit: {{ userManagementRowData.landLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<!-- <input type="text" pInputText name="titleRegisterHitLimit" [(ngModel)]="userManagementRowData.titleRegisterHitLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )" [disabled]="userManagementRowData.titleRegisterHitLimit"> -->
							<div class="p-inputtext p-inputwrapper-filled disabled" style="line-height: 1.15;">{{ userManagementRowData.titleRegisterHitLimit | number : '1.0-0' }}</div>
							<label class="disabled">Title Register</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Title Register Limit: {{ userManagementRowData.titleRegisterHitLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="companyReport" [(ngModel)]="userManagementRowData.companyReport" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Company Report</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Company Report: {{ userManagementRowData.companyReport | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="directorReportLimit" [(ngModel)]="userManagementRowData.directorReportLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
								<label>Director Report</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Director Report: {{ userManagementRowData.directorReportLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="creditReportLimit" [(ngModel)]="userManagementRowData.creditReportLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Credit Report</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Credit Report: {{ userManagementRowData.creditReportLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="directorMonitorLimit" [(ngModel)]="userManagementRowData.directorMonitorLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Director Monitor</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Director Monitor: {{ userManagementRowData.directorMonitorLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="companyMonitorLimit" [(ngModel)]="userManagementRowData.companyMonitorLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Business Monitor</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Business Monitor: {{ userManagementRowData.companyMonitorLimit | number : '1.0-0' }}</div>
					</div>
					
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="companyMonitorPlusLimit" [(ngModel)]="userManagementRowData.companyMonitorPlusLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )" [disabled]="!addOnNgModel?.companyMonitorPlus">
							<label>Business Monitor Plus</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Business Monitor Plus: {{ userManagementRowData.companyMonitorPlusLimit | number : '1.0-0' }}</div>
					</div>

					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="api_hits"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.api_hits" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>API Hits</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">API Hits: {{ userManagementRowData.api_hits | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="api_hits"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.pepAndSanctionHitLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Pep & Sanctions Hit</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Pep & Sanctions Hit: {{ userManagementRowData.pepAndSanctionHitLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="emailSpotterLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.emailSpotterLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Email Spotter Hit</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Email Spotter Hit: {{ userManagementRowData.emailSpotterLimit | number : '1.0-0' }}</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="salesforcePushDataLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.salesforcePushDataLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Salesforce Push Data</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Salesforce Push Data Limit: {{ userManagementRowData.salesforcePushDataLimit | number : '1.0-0' }}</div>
					</div>
					
					<div class="col-12 md:col-6 lg:col-3" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
						<div class="grid">
							<div class="col-fixed mt-3" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
								<small>
									<p-checkbox [(ngModel)]="userManagementRowData.isMultipleDeviceLogin" binary="true"></p-checkbox>
								</small>
							</div>
							<div class="col">
								<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
									<p-inputNumber name="activeLicenses" inputId="integeronly" [disabled]="!userManagementRowData.isMultipleDeviceLogin" [min]="1" [max]="9" [(ngModel)]="userManagementRowData.activeLicenses" [maxlength]="1">
									</p-inputNumber>
									<label>No. of Device Access</label>
									<span class="c-light font-italic">
										<small class="mt-1" style="float: left; font-style: italic" >
											Please enter value between 1 to 9.
										</small>
									</span>
								</span>

								<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">No. of Device Access: {{ userManagementRowData.activeLicenses | number : '1.0-0' }}</div>

							</div>
						</div>
					</div>
	
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="contactInformationLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.contactInformationLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Contact Information Export</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Contact Information Export: {{ userManagementRowData.contactInformationLimit | number : '1.0-0' }}</div>
					</div>
					<div class="col-12 md:col-6 lg:col-3">
						<span class="p-float-label" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
							<input type="text" pInputText name="enterpriseReportLimit"  pKeyFilter="num" min="0" [(ngModel)]="userManagementRowData.enterpriseReportLimit" [readonly]="!userAuthService.hasRolePermission( ['Super Admin'] )">
							<label>Enterprise Report Limit</label>
						</span>
						<div class="heading-font" *ngIf="!userAuthService.hasRolePermission( ['Super Admin'] )">Enterprise Report Limit: {{ userManagementRowData.enterpriseReportLimit | number : '1.0-0' }}</div>
					</div>
	
				</div>
	
			</p-accordionTab>
	
			<!-- <p-accordionTab header="{{ userAuthService.hasRolePermission( ['Client Admin'] ) || userRoleAndFeatureAuthService.isClientAdminMaster() ? 'Available Add On' : 'Add On' }}" [selected]="true" *ngIf="userRoleFinal && (userRoleAndFeatureAuthService.isAdmin() && !['Client Admin', 'Client User'].includes(userRoleFinal)) || ( (userAuthService.hasRolePermission( ['Client Admin'] ) || userRoleAndFeatureAuthService.isClientAdminMaster()) && !['Client User'].includes(userRoleFinal))">
	
				<div class="grid p-3 p-fluid">

					<ng-container *ngFor="let rowData of addOnDetails">
	
						<ng-container *ngIf="userRoleAndFeatureAuthService.isAdmin() || ( !userRoleAndFeatureAuthService.isAdmin() && !rowData.hasOwnProperty('disable') && !rowData.hasOwnProperty( 'visibleOnlyForAdmin' ) ) ">
							<span class="col-12 md:col-6 lg:col-3">
								<p-checkbox *ngIf="userRoleAndFeatureAuthService.isAdmin()" [(ngModel)]="addOnNgModel[rowData.field]" label= {{rowData.label}} [binary]="true" [disabled]="rowData.hasOwnProperty('disable')? rowData.disable : false"></p-checkbox>

								<ng-container *ngIf="!userRoleAndFeatureAuthService.isAdmin() && !rowData.hasOwnProperty('disable') && !rowData.hasOwnProperty( 'visibleOnlyForAdmin' )">
									
									<ng-container *ngIf="addOnNgModel[rowData.field] == true; else whenNoFilterOn">
										<span>
											<i class="material-icons c-green">check_circle</i>
											{{rowData.label}}
										</span>
									</ng-container>
									<ng-template #whenNoFilterOn>
										<span>
											<i class="material-icons c-red">cancel</i>
											{{rowData.label}}
										</span>
									</ng-template>
	
								</ng-container>
							</span>

						</ng-container>

					</ng-container>
	
				</div>
	
			</p-accordionTab>
	
			<p-accordionTab header="Business Intelligence" [selected]="true" *ngIf="userRoleFinal && (userRoleAndFeatureAuthService.isAdmin() && !['Client Admin', 'Client User'].includes(userRoleFinal)) || ( (!userRoleAndFeatureAuthService.isAdmin() || userRoleAndFeatureAuthService.isClientAdminMaster()) && !['Client User'].includes(userRoleFinal))">
	
				<div class="grid p-3 p-fluid">

					<ng-container *ngFor="let rowData of bussinessIntelligenceDetails">
	
						<span class="col-12 md:col-6 lg:col-3">
							<p-checkbox *ngIf="userRoleAndFeatureAuthService.isAdmin()" [(ngModel)]="addOnNgModel[rowData.field]" label= {{rowData.label}} [binary]="true" ></p-checkbox>
							<ng-container *ngIf="!userRoleAndFeatureAuthService.isAdmin()">
								<ng-container *ngIf="rowData.field == true; else whenNoFilterOn">
										<i class="material-icons c-green">check_circle</i>
										{{rowData.label}}
								</ng-container>
								<ng-template #whenNoFilterOn>
									<ng-container *ngIf="addOnNgModel[rowData.field]; else whenNoFilterOn">
										<i class="material-icons c-green">check_circle</i>
										{{rowData.label}}
									</ng-container>
									<ng-template #whenNoFilterOn>
										<i class="material-icons c-red">cancel</i>
										{{rowData.label}}
									</ng-template>
								</ng-template>
							</ng-container>
						</span>

					</ng-container>
	
				</div>
	
			</p-accordionTab> -->

			<p-accordionTab header="{{ userAuthService.hasRolePermission( ['Client Admin Master', 'Client Admin'] ) ? 'Available Add On' : 'Add On' }}" [selected]="true" *ngIf="userRoleFinal && ( userAuthService.hasRolePermission( ['Super Admin'] ) && !['Client Admin', 'Client User'].includes( userRoleFinal ) ) || ( ( userAuthService.hasRolePermission( ['Client Admin Master', 'Client Admin'] ) ) && !['Client User'].includes( userRoleFinal ) )">

				<dg-shared-addon-list [showAddonList]="'addOnDetails'" [isAdmin]="userAuthService.hasRolePermission( ['Super Admin'] )" [editMode]="true" [addOnNgModel]="addOnNgModel" (AddonListCommunicator)="addonDataList($event)"></dg-shared-addon-list>
	
			</p-accordionTab>
	
			<p-accordionTab header="Business Intelligence" [selected]="true" *ngIf="userRoleFinal && ( userAuthService.hasRolePermission( ['Super Admin'] ) && !['Client Admin', 'Client User'].includes( userRoleFinal ) ) || ( (!userAuthService.hasRolePermission( ['Super Admin'] ) || userAuthService.hasRolePermission( ['Client Admin Master'] ) ) && !['Client User'].includes( userRoleFinal ) )">

				<dg-shared-addon-list [showAddonList]="'bussinessIntelligenceDetails'" [editMode]="true" [isAdmin]="userAuthService.hasRolePermission( ['Super Admin'] )" [addOnNgModel]="addOnNgModel" (AddonListCommunicator)="($event)" ></dg-shared-addon-list>
	
			</p-accordionTab>
		</ng-container>
	
	</p-accordion>

	<div class="mt-5">
		<button pButton type="button" label="Update Details" class="p-button-rounded p-button-lg p-mb-0" (click)="updateUserData()"></button>
	</div>

</div>

<div class="card pt-2" *ngIf="userManagementRowData?.userRole && ( userAuthService.hasRolePermission( ['Super Admin'] ) && !['Client Admin', 'Client User', 'Individual'].includes( userManagementRowData?.userRole ) && !corporateUserEditView && ( [ subscribedPlanModal['Monthly_Enterprise'], subscribedPlanModal['Enterprise_Annual_One_Year'], subscribedPlanModal['Enterprise_Annual_Two_Year'], subscribedPlanModal['Enterprise_New_Monthly'], subscribedPlanModal['Monthly_Enterprise_Paid_Test'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Monthly_Enterprise_Trial'], subscribedPlanModal['Annually_Enterprise'], subscribedPlanModal['Annually_Enterprise_Trial'], subscribedPlanModal['Enterprise_Conversion_For_Ravi'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Premium_New_Monthly'], subscribedPlanModal['Premium_Annual_One_Year'], subscribedPlanModal['Premium_Trial_48_Hours'], subscribedPlanModal['Premium_Annual_Two_Year'] ].includes( currentPlanForUser ) ) )">

	<p-accordion [multiple]="true" styleClass="onlyLinesAround" (onClose)="onAccordionTabClose( $event )">

		<p-accordionTab header="User List">

			<dg-admin-record-list [listColumns]="updateUserTableCols" [listDataValues]="userDetails" [searchTotalCount]="userDetails?.total" [thisPage]="'update-user'" [userRoleInput]="userManagementRowData" (updateTableAfterPagination)="getUserUpdateData( $event )" [isClientAdminBool]="isClientAdminBool" *ngIf="userManagementRowData.email"></dg-admin-record-list>

		</p-accordionTab>

		<p-accordionTab header="Teams" id="teamPageContainerAccordion" [selected]="teamPageContainerAccordionBoolean">

			<dg-client-team-management [userDetailsInput]="userManagementRowData" [thisPage]="'updateUserDetailsPage'" *ngIf="userManagementRowData.email" [updateUserDetailsTeamFeature]="updateUserDetailsTeamFeature"></dg-client-team-management>

		</p-accordionTab>

	</p-accordion>
	
</div>

<!-- Logged Devices IP Info Block -->
<div #companyQuickInfoPopover class="card companyDetailPopup" *ngIf="quickInfoData">
	<div class="p-mb-2">
		<h5 class="p-mt-0 p-mb-2">Logged Devices IP Details</h5>
	</div>
	<hr>
	<ng-container *ngFor="let data of quickInfoData">
		<div class="popoverListItem">
			<i class="bg-grey ui-icon-devices p-mb-2"></i>
			<span class="c-grey p-ml-3">{{ data['ip'] }}</span>
		</div>
	</ng-container>
</div>
<!-- Logged Devices IP Info Block END -->