<p-messages [value]="msgs"></p-messages>

<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle" [key]="thisPage" appendTo="body" styleClass="logoutConfirmationDialogStyling customDialogButtonSwap" [baseZIndex]="999999999"></p-confirmDialog>

<p-dialog header="Invested Company" [modal]="true" [(visible)]="showInvestedCompany" [style]="{ width: '75rem' }" appendTo="body" [draggable]="false" [baseZIndex]="999999998" [focusOnShow]="false">
    <p-table [columns]="investedCompanyColumnData" [value]="investedCompanyData" [tableStyle]="{ 'min-width': '70rem' }">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.textAlign }">
                    {{ col.header }}
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
                <td *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.textAlign }">
                    {{ rowData[col.field] ? ( rowData[col.field] | titlecase ) : '-' }}
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="columns?.length">No records found.</td>
            </tr>
        </ng-template>
    </p-table>               
</p-dialog>

<dg-short-detail-sidefilter [overviewName]="'companyOverview'" *ngIf="showCompanySideDetails && overviewName == 'companyOverview'" [companySideDetailsParams]="companySideDetailsParams" [showCompanySideDetailsInputBool]="showCompanySideDetails" (showCompanySideDetailsOutputBool)="getShowCompanySideDetailsOutputBoolValue($event)"></dg-short-detail-sidefilter>

<!-- Below line of code is rendering the table template on the page -->
<ng-container [ngTemplateOutlet]="adminRecordListTableTemplate" [ngTemplateOutletContext]="{ $implicit: { tableColumns: listColumns, tableDataValues: listDataValues } }"></ng-container>
<!-- Below line of code is rendering the table template on the page End -->

<!-- Login Modal Dialog -->
<p-dialog styleClass="loginDialogModal" [modal]="true" [(visible)]="showLoginDialog" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" (onHide)="showLoginDialog=false">
	<dg-login></dg-login>
</p-dialog>
<!-- Login Modal Dialog End -->

<!-- Upgrade Plan Dialog -->
<p-dialog styleClass="subscriptionPlanDialogModal" [modal]="true" [(visible)]="showUpgradePlanDialog" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{ width: 'auto' }" (onHide)="closeDialogBox()">
    <dg-upgrade-plan [currentPlan]="userDetails?.planId" [componentView]="'inModal'"></dg-upgrade-plan>
</p-dialog>
<!-- Upgrade Plan Dialog End -->
<p-dialog [modal]="true" [blockScroll]="true" [(visible)]="showLoginDialog" [baseZIndex]="999999998" appendTo="body"
    [focusOnShow]="false" (onHide)="showLoginDialog=false">
    <div class="grid">
        <div class="col-6 text-center">
            <div class="card bg-blue-100 p-1">
                <p class="mt-0"><strong>OrganisationID</strong></p>
                <h2 class="my-2 p-font-bold">{{ipAddressData?.OrganisationID}}</h2>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="card bg-blue-100 p-1">
                <p class="mt-0"><strong>OrganisationType</strong></p>
                <h2 class="my-2 p-font-bold">{{ipAddressData?.OrganisationType | titlecase}}</h2>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="card bg-blue-100 p-1">
                <p class="mt-0"><strong>Organisation</strong></p>
                <h2 class="my-2 p-font-bold">{{ipAddressData?.Organisation | titlecase}}</h2>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="card bg-blue-100 p-1">
                <p class="mt-0"><strong>HostName</strong></p>
                <h2 class="my-2 p-font-bold">{{ipAddressData?.HostName | titlecase}}</h2>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="card bg-blue-100 p-1">
                <p class="mt-0"><strong>OrgPhone</strong></p>
                <h2 class="my-2 p-font-bold">{{ipAddressData?.OrgPhone ? ipAddressData?.OrgPhone : 0}}</h2>
            </div>
        </div>
    </div>

    <div class="text-center">
        <button pButton type="button" class="p-button-rounded darkGrey" label="Close"
            (click)="showLoginDialog=false"></button>
    </div>

</p-dialog>
<!-- User management User Info Table -->
<p-dialog header="User's Limit History" [(visible)]="userMgmtDetailsInfoDialogModal" [modal]="true" [baseZIndex]="999999998" appendTo="body" [style]="{width: '85%'}" [draggable]="false" [focusOnShow]="false">
    
    <div class="card">
        <p-table [value]="userDetailsInfoData" [columns]="userDetailsInfoDataColumn" dataKey="label">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns">{{ col.header }}  </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex" let-expanded="expanded" let-columns="columns">
                <tr *ngIf="rowGroupMetadata[ rowData.label ].index === rowIndex">
                    <td [attr.colspan]="columns?.length">
                        <button type="button" pButton [pRowToggler]="rowData" class="mr-3 p-button-small p-button-rounded p-button-lg p-button-icon-only" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                        <span class="text-center spanClass"> <strong>{{ rowData.label }}</strong></span>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">
                <tr>
                    <td *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.textAlign, 'vertical-align': col.verticalAlign }" [ngSwitch]="true">                        
                      
                        <ng-container *ngSwitchCase="col.field == 'limitUsed'">
                            <ng-container *ngIf="rowData[col.field]; else showZeroBlock">
                                <span class="c-red font-semibold">-{{ rowData[col.field] }}</span> 
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'availableLimit'">
                            <ng-container *ngIf="rowData[col.field]; else showZeroBlock">
                                {{ rowData[col.field] }}
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'limitAdded'">
                            <ng-container *ngIf="rowData[col.field]; else showZeroBlock">
                                <ng-container *ngIf="rowData['status'] == 'plus'">
                                    <span class="c-green font-semibold">+{{ rowData[col.field] }}</span> 
                                </ng-container>
                                <ng-container *ngIf="rowData['status'] == 'minus'">
                                    <span class="c-red font-semibold">-{{ rowData[col.field] }}</span>  
                                </ng-container>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchDefault>                           
                            {{ ( rowData[col.field] || rowData[col.field] == 0 ? rowData[col.field] : '-' ) }}                          
                        </ng-container>

                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>
				<tr>
					<td [attr.colspan]="columns?.length">No records found.</td>
				</tr>
			</ng-template>
        </p-table>
    </div>
</p-dialog>
<!-- User management User Info Table End -->

<!-- Create New User Dialog -->
<p-dialog styleClass="loginDialogModal hasSignUPComponent" [modal]="true" [(visible)]="createNewUserDialog" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{width: '75vw'}" (onHide)="cancelPlanDialogBox()">

    <ng-container *ngIf="userAuthService.hasRolePermission( ['Super Admin'] ) && thisPage !== 'update-user'">

        <div class="login-body forDialog" *ngIf="!planSelected">
            <div class="login-panel">
                <div class="card">
                    <div class="col">
                        <div class="col-12 pt-0 text-center">
                            <h4 class="p-m-0 fontViewForMobile"><strong>Choose Plan Type</strong></h4>
                        </div>
                    </div>
                    <div class="grid align-items-center text-left p-input-filled">
                        <div class="col-12 mb-2">
                            <p-dropdown [options]="planNamesArray" placeholder="Select a plan" [(ngModel)]="selectedPlanName" (onChange)="choosePlanEvent()" styleClass="fontViewForMobile"></p-dropdown>
                            <span class="c-red" *ngIf="planNotSelected">
                                <small>Please select a plan</small>
                            </span>
                        </div>
                        <div class="col mb-4 text-center" >
                            <button pButton type="button" label="Trial 24 Hours" class="p-button-rounded p-button-lg mr-2" (click)="selectPlan('trial')" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] ) && userRoleInput?.userRole !== 'Client Admin' && !userAuthService.hasRolePermission( ['Client Admin'] )"></button>
                            <button pButton type="button" label="Month" class="p-button-rounded p-button-lg mr-2" (click)="selectPlan('monthly')"></button>
                            <button pButton type="button" label="Annual" class="p-button-rounded p-button-lg" (click)="selectPlan('annualy')"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </ng-container>

    <ng-container *ngIf="planSelected || ( createNewUserDialog && ( userAuthService.hasRolePermission( ['Client Admin'] ) || userAuthService.hasRolePermission( ['Team Admin'] ) || thisPage == 'update-user' || userAuthService.hasRolePermission( ['Client Admin Master'] ) ) )">
        <dg-createAccount [requestFormData]="{ thisPage: 'user-management', planDetails: planDetails }" (requestReturnToPage)="getReturnedRequestFromSignUp( $event )" [userRoleInput]="userRoleInput"></dg-createAccount>
    </ng-container>

</p-dialog>
<!-- Create New User Dialog End -->

<!-- <p-dialog header="Diversity Calculation" [(visible)]="NewPopUpBool" [modal]="true" [style]="{ width: '95vw' }" [draggable]="false" [resizable]="false">
    <dg-diversity-calculation-stats [listIdForDiversityStats]="listId" [globalFilterDataObject]="globalFilterDataObject" *ngIf="NewPopUpBool"></dg-diversity-calculation-stats>
</p-dialog> -->

<ng-template #adminRecordListTableTemplate let-tableInputValues>
    <div class="card border-noround	responsiveadminRecordListTable">
        <p-table #adminRecordListTable [columns]="tableInputValues.tableColumns" [value]="tableInputValues.tableDataValues.userDetails ? tableInputValues.tableDataValues.userDetails : tableInputValues?.tableDataValues" [(selection)]="selectedCompany" responsiveLayout="scroll" [scrollable]="true" scrollHeight="65vh" dataKey="{{obj}}" [exportFilename]="exportListDynamicName" *ngIf="tableInputValues.tableDataValues" [reorderableColumns]="true" (sortFunction)="defaultTableSort($event, adminRecordListTable)" [customSort]="true" (onRowSelect)="selectedTableRoworHeader( selectedCompany )" (onHeaderCheckboxToggle)="selectedTableRoworHeader( selectedCompany )" (onRowUnselect)="selectedTableRoworHeader( selectedCompany )" [paginator]="[ 'netZero', 'webWidgetPage', 'overviewLinkedinProfile' ].includes( thisPage ) ? true : false" [rows]="rows" [first]="first" [rowsPerPageOptions]="[25, 50, 100]" paginatorPosition="top" (onPage)="pageChanges($event, adminRecordListTable)">

            <ng-template pTemplate="caption">

                <div class="flex align-items-center justify-content-end mb-4 font-normal" style="color: var(--lighten-dark-grey);" *ngIf="thisPage == 'esgWatchPage'">
                    <i class="pi pi-info-circle mr-2 fs-large"></i>
                    <span>The below information for "current" and "previous" is based on the financial year.</span>
                </div>

                
                <ng-container *ngIf="[ 'diversityCalculation', 'supplierResilience' ].includes( thisPage )">

                    <div class="grid align-items-center">
                            
                        <div class="col-fixed">
                            <h4 class="m-2 lg:inline-flex hidden text-lg">{{ searchTotalCount | number }} Results Found</h4>
                        </div>

                        <div class="col-fixed ml-auto">

                            <ng-container *ngFor="let status of companyStatusCount; let i = index">
                                <a href="javascript:void(0);" class="p-d-block" (click)="gotToSearchPage( status, thisPage )">

                                    <span class="status text-base mr-2" [ngClass]="{'c-green': status.key == 'live' || status.key =='administration order', 'c-red': status.key == 'dissolved' || status.key == 'converted/closed' || status.key == 'in administration' || status.key == 'in receivership / administration' || status.key == 'in receivership' || status.key == 'deleted' || status.key == 'voluntary arrangement' || status.key == 'removed','c-orange':  status.key == 'in liquidation' }">
                                        <span>{{  commonService.camelCaseToTitleCaseStr( (status.key == '' ? 'Other' : status.key)  )}}: {{ status.doc_count | number }}</span>
                                        <div *ngIf="[ 'diversityCalculation', 'supplierResilience' ].includes( thisPage )">
                                            <!-- <span>Spend: </span> -->
                                            <span>{{ status?.spendTotal ? ( status.spendTotal | currency: 'GBP' : 'symbol' : '1.0-0' ) : 0 }}</span>
                                        </div>
                                    </span>
                                </a>
        
                            </ng-container>

                        </div>
    
                    </div>

                </ng-container>

                <ng-container *ngIf="[ 'diversityInclusion'].includes( thisPage )">

                    <div class="grid align-items-center">
                            
                        <div class="col-fixed">
                            <h4 class="m-2 lg:inline-flex hidden text-lg">{{ searchTotalCount | number }} Results Found</h4>
                        </div>

                        <div class="col-fixed ml-auto">

                            <ng-container *ngFor="let status of companyStatusCount; let i = index">
                                    <span class="status text-base mr-2" [ngClass]="{'c-green': status.key == 'live' || status.key =='administration order', 'c-red': status.key == 'dissolved' || status.key == 'converted/closed' || status.key == 'in administration' || status.key == 'in receivership / administration' || status.key == 'in receivership' || status.key == 'deleted' || status.key == 'voluntary arrangement' || status.key == 'removed','c-orange':  status.key == 'in liquidation' }">
                                        <span>{{  commonService.camelCaseToTitleCaseStr( (status.key == '' ? 'Other' : status.key)  )}}: {{ status.doc_count | number }}</span>
                                        <div *ngIf="[ 'diversityCalculation', 'supplierResilience' ].includes( thisPage )">
                                            <!-- <span>Spend: </span> -->
                                            <span>{{ status?.spendTotal ? ( status.spendTotal | currency: 'GBP' : 'symbol' : '1.0-0' ) : 0 }}</span>
                                        </div>
                                    </span>
        
                            </ng-container>

                        </div>
    
                    </div>

                </ng-container>
                    
    
                <div class="grid align-items-end text-left">
                    
                    <div class="col-12" *ngIf="[ 'user-management' ].includes( thisPage )">
    
                        <div class="grid justify-content-end">
                            <div class="col-fixed">
                                <ng-container *ngIf="tableInputValues.tableDataValues.total > 0; else zeroTotalUser">
                                    <a href="javascript:void(0);" (click)="resetFilters( adminRecordListTable )">
                                       <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-green': tableInputValues.tableDataValues.total > 0 }"> Total Users: <strong>{{ tableInputValues.tableDataValues.total | number }}</strong> </h3>
                                    </a>
                                </ng-container>
                                <ng-template #zeroTotalUser>
                                    <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-green': tableInputValues.tableDataValues.total > 0 }"> Total Users: <strong>{{ tableInputValues.tableDataValues.total | number }}</strong> </h3>
                                </ng-template>
                            </div>
                            <div class="col-fixed" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
                                <ng-container *ngIf="tableInputValues.tableDataValues.paid > 0; else zeroPaidUser">
                                    <a href="javascript:void(0);" (click)="applyFilter( $event, adminRecordListTable, 'paiduser', 'contains' )">
                                        <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-voilet': tableInputValues.tableDataValues.paid > 0 }"> Paid Users: <strong>{{ tableInputValues.tableDataValues.paid | number }}</strong> </h3>
                                    </a>
                                </ng-container>
                                <ng-template #zeroPaidUser>
                                    <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-voilet': tableInputValues.tableDataValues.paid > 0 }"> Paid Users: <strong>{{ tableInputValues.tableDataValues.paid | number }}</strong> </h3>
                                </ng-template>
                            </div>
                            <div class="col-fixed" *ngIf="userAuthService.hasRolePermission( ['Super Admin'] )">
                                <ng-container *ngIf="tableInputValues.tableDataValues.free > 0; else zeroFreeUser">
                                    <a href="javascript:void(0);" (click)="applyFilter( $event, adminRecordListTable, 'freeuser', 'contains' )">
                                        <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-royalBlue': tableInputValues.tableDataValues.free > 0 }"> Free Users: <strong>{{ tableInputValues.tableDataValues.free | number }}</strong> </h3>
                                    </a>
                                </ng-container>
                                <ng-template #zeroFreeUser>
                                    <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-royalBlue': tableInputValues.tableDataValues.free > 0 }"> Free Users: <strong>{{ tableInputValues.tableDataValues.free | number }}</strong> </h3>
                                </ng-template>
                            </div>
                        </div>
    
                    </div>

                    <div class="col-12" *ngIf="['update-user'].includes( thisPage )">
                        <div class="grid justify-content-end">
                            <div class="col-fixed">
                                <h3 class="roundedColoredChipLabel fontViewForMobile p-m-0" [ngClass]="{ 'c-green': tableInputValues.tableDataValues.total > 0 }">Total Users: <strong>{{ tableInputValues.tableDataValues.total | number }}</strong></h3>
                            </div>
                        </div>
                    </div>
    
                    <div [ngClass]="['showChargesTablePage'].includes(thisPage) ? 'col-12 xl:col-12' : 'col-12 xl:col-8'">

                        <div>
                            <ng-container *ngIf="[ 'showChargesTablePage', 'showTradeTablePage' ].includes(thisPage)">
                                <button pButton *ngIf="searchCompanyService.showStatsButton" type="button" class="p-button-rounded p-button-sm ml-2 mb-3" (click)="goToStatsPage('statsScreen')" label="Stats" icon="pi pi-chart-line"  [disabled]="listDataValues && listDataValues?.length === 0"></button>
                                <button *ngIf="searchCompanyService.showStatsButton && selectedGlobalCountry == 'uk'" type="button" pButton class="p-button-rounded p-button-sm ml-2 mb-3 bg-blue-600"  label="Growth Anaysis" icon="pi pi-chart-line" (click)="goToStatsPage('growthAnaysis')" [disabled]="listDataValues && listDataValues?.length === 0"></button>
                            </ng-container>
    
                            <ng-container *ngIf="showHeaderObj['listId']; else otherResult">
                                <h4 *ngIf="[ 'showChargesTablePage', 'showDirectorScreenPage', 'investorFinderPage', 'investeeFinderPage', 'corporateRiskPage', 'esgWatchPage', 'buyersDashboard', 'suppliersDashboard', 'contractFinderPage', 'showTradeTablePage' ].includes( thisPage )" class="mb-3 ml-3 mt-2 lg:inline-flex hidden text-lg">
                                    {{ searchTotalCount | number }} Results Found in the &nbsp;<strong>{{ showHeaderObj.listName | titlecase }}</strong>&nbsp; from &nbsp;<strong> {{ showHeaderObj.listPageName | titlecase }} </strong>
                                    <span class="c-light ml-3" *ngIf="[ 'showChargesTablePage' ].includes(thisPage)">Note : Aggregate count in months are for outstanding charges only</span>
                                </h4>
                            </ng-container>
                        </div>

                        <ng-template #otherResult>
                            <h4 *ngIf="[ 'showChargesTablePage', 'showDirectorScreenPage', 'investorFinderPage', 'investeeFinderPage', 'corporateRiskPage', 'esgWatchPage', 'buyersDashboard', 'suppliersDashboard', 'contractFinderPage', 'showTradeTablePage', 'netZero', 'ppcPage', 'payments' ].includes( thisPage )" class="mb-3 ml-3 mt-2 lg:inline-flex hidden text-lg">
                                <ng-container *ngIf="[ 'showDirectorScreenPage' ].includes(thisPage); else other">
                                    {{ directorTotalCount | number }} Results Found
                                </ng-container>
                                <ng-template #other>
                                    <ng-container *ngIf="thisPage != 'showChargesTablePage'; else chargesCase">
                                        {{ searchTotalCount | number }} Results Found 
                                    </ng-container>
                                    <ng-template #chargesCase>{{ searchTotalCount | number }} Companies Found</ng-template>
                                </ng-template>
                                <span class="c-light ml-3" *ngIf="[ 'showChargesTablePage' ].includes(thisPage)">Note : Aggregate count in months are for outstanding charges only</span>
                            </h4>
                        </ng-template>

                        <h4 *ngIf="[ 'hnwiPage' ].includes( thisPage )" class="mb-3 lg:inline-flex hidden text-lg">
                            {{ searchTotalCount | number }} HNWI Found
                        </h4>

                        <ng-container *ngIf="thisPage == 'showContactScreen'">
                            <h4>{{ totalContacts | number }} Contacts Results Found in {{ searchTotalCount | number }} Companies</h4>
                        </ng-container>
                        
                        <ng-container *ngIf="thisPage == 'customerWatchPage'">
                            <h4 class="mb-3 lg:inline-flex hidden">
                                {{ totalNoOfRecords | number }} Results Found
                            </h4>
                            <button pButton *ngIf="( userAuthService.isLoggedInSubject$ | async )" type="button" class="p-button-rounded p-button-sm ml-2 mb-3" (click)="goToStatsPage('statsScreen')" label="Stats" icon="pi pi-chart-line"  [disabled]="listDataValues && listDataValues?.length === 0"></button>
                            <button type="button" *ngIf="( userAuthService.isLoggedInSubject$ | async ) && selectedGlobalCountry == 'uk'" pButton class="p-button-rounded p-button-sm ml-2 mb-3 bg-blue-600"  label="Growth Anaysis" icon="pi pi-chart-line" (click)="goToStatsPage('growthAnaysis')" [disabled]="listDataValues && listDataValues?.length === 0"></button>
                        </ng-container>

                        <ng-container *ngIf="thisPage == 'promptSearchAi'"><h4 class="ml-3 mt-2 text-lg">{{ searchTotalCount | numberSuffix: '2' }} Results Found!</h4></ng-container>

                        <div class="flex flex-column md:flex-row">
                            
                            <button pButton type="button" class="p-button-rounded mr-3 p-button-sm darkGrey mb-xxl-2" label="Reset Table"  icon="pi pi-replay" *ngIf="( [ 'customerWatchPage', 'companyListOfIServiceCategoryPage', 'showChargesTablePage', 'showDirectorScreenPage', 'investorFinderPage', 'investeeFinderPage', 'corporateRiskPage', 'user-management', 'hnwiPage', 'buyersDashboard', 'esgWatchPage', 'buyerNonRegPage', 'supplierNonRegPage', 'suppliersDashboard', 'supplierDashboard', 'contractFinderPage', 'showTradeTablePage', 'webWidgetPage', 'diversityCalculation', 'netZero', 'ppcPage', 'payments', 'promptSearchAi', 'supplierResilience'].includes( thisPage ) || trade || ([ 'diversityInclusion' ].includes( thisPage ) && listId) )" (click)="resetFilters(adminRecordListTable)"></button>

                            <ng-container *ngIf="thisPage != 'netZero'">

                                <ng-container *ngIf="[ 'showContactScreen' ].includes( thisPage )">
                                    <dg-export-record-list [tableData]="adminRecordListTable" [appliedFilters]="preparedPayloadBody.filterData" [selectedCompany]="selectedCompany" [companyTotalCount]="companyTotalCount" [thisPage]="thisPage" [listDataValues]="listDataValues" [filterSearchArray]="filterSearchArray" [listId]="listId" (successMessage)="successMessageForExport( $event )" [exportListDynamicName]="exportListDynamicName" [searchTotalCount]="totalContacts" [newCompanyCount]="searchTotalCount"></dg-export-record-list>
                                </ng-container>
                            
                                <dg-export-admin-record-list [appliedFilters]="preparedPayloadBody.filterData" [selectedCompany]="selectedCompany" [thisPage]="thisPage" [listDataValues]="listDataValues" (successMessage)="successMessageForExport( $event )" [adminRecordListTable]="adminRecordListTable" (resetFilters)="resetFilterTableFromExport( $event )" [searchTotalCount]="searchTotalCount" [showExportFilterBtn]="showExportFilterBtn" [listId]="listId" [hideExportToAllButn]="hideExportToAllButn" [showExportFilterBtn]="showExportFilterBtn">
                                </dg-export-admin-record-list>
    
                                <ng-container *ngIf="[ 'diversityInclusion' ].includes( thisPage ) && listId">
    
                                    <dg-export-record-list [tableData]="adminRecordListTable" [appliedFilters]="preparedPayloadBody.filterData" [selectedCompany]="selectedCompany" [searchTotalCount]="searchTotalCount" [companyTotalCount]="companyTotalCount" [thisPage]="thisPage" [listDataValues]="listDataValues" [filterSearchArray]="filterSearchArray" [listId]="listId" (successMessage)="successMessageForExport( $event )" [exportListDynamicName]="exportListDynamicName"></dg-export-record-list>
    
                                    <ng-container *ngIf="adminRecordListTable">
    
                                        <dg-export-template [tableData]="adminRecordListTable" [selectedCompany]="selectedCompany"  [searchTotalCount]="searchTotalCount" [thisPage]="thisPage" [appliedFilters]="preparedPayloadBody.filterData" [filterSearchArray]="filterSearchArray" [exportFilteredDataBool]="exportFilteredDataBool" [listId]="listId" (successMessage)="successMessageForExport( $event )" [tableName]="'recordList'" (thisPageExportTemplate)="thisPageExportTemplate( $event )"></dg-export-template>
                                    </ng-container>
    
                                </ng-container>
                                
                            </ng-container>
                            
                            <dg-add-company-to-list *ngIf="['companyListOfIServiceCategoryPage', 'showChargesTablePage', 'buyersDashboard','suppliersDashboard','showTradeTablePage', 'webWidgetPage', 'investorFinderPage', 'investeeFinderPage', 'promptSearchAi'].includes(thisPage) && activeRoute.snapshot.queryParams['pageName'] != 'savedPortFolioPage'" [selectedCompany]="selectedCompany" [thisPage]="thisPage" (messageCommunicator)="getMessage($event)" [disableButton]="selectedCompany?.length == 0" [searchTotalCount]="listDataValues?.length" [appliedFilters]="preparedPayloadBody.filterData || appliedFilters.filterData" [queryId]="queryId"></dg-add-company-to-list>

							<ng-container *ngIf="userAuthService.hasRolePermission( ['Under Development'] )">
                                 <dg-add-contact-to-list *ngIf="['showContactScreen'].includes(thisPage) && showListButton" [selectedCompany]="selectedCompany" [thisPage]="thisPage" (messageCommunicator)="getMessage($event)" [disableButton]="selectedCompany?.length == 0" [searchTotalCount]="listDataValues?.length" [appliedFilters]="preparedPayloadBody.filterData"></dg-add-contact-to-list>
                            </ng-container>
                        
                            <button *ngIf="['customerWatchPage'].includes( thisPage ) " pButton type="button" [disabled]="selectedCompany?.length == 0" label="Delete" icon="ui-icon-delete" class="p-button-rounded p-button-danger p-button-sm mb-xxl-2" (click)="deleteCustomerWatchRow()"></button>

                            <button *ngIf="['esgWatchPage'].includes( thisPage ) " pButton type="button" [disabled]="selectedCompany?.length == 0" label="Delete" icon="ui-icon-delete" class="p-button-rounded p-button-danger p-button-sm mb-xxl-2" (click)="deleteEsgWatchRow()"></button>

                            <button *ngIf="thisPage == 'customerWatchPage'" pButton type="button" label="Company Notification" icon="ui-icon-search" class="p-button-rounded p-button-sm mb-xxl-2 ml-3" (click)="searchCustomerNotifiation()"></button>

                            <button pButton *ngIf="thisPage === 'user-management' || thisPage === 'update-user'" type="button" label="Delete" [disabled]="( selectedCompany?.length === 0 ) || ( selectedCompany?.length > 0 && selectCompanyBoolean )" icon="ui-icon-delete" class="p-button-rounded p-button-danger p-button-sm mr-2" (click)="deleteUserData( adminRecordListTable, selectedCompany )"></button>

                            <button pButton *ngIf="thisPage === 'user-management' || thisPage === 'update-user'" type="button" label="Create New User" icon="ui-icon-plus" class="p-button-rounded p-button-sm" [disabled]="userRoleInput && userRoleInput?.userRole !== 'Client Admin Master' && !userAuthService.hasRolePermission( ['Client Admin'] )" (click)="createNewUser()"></button>

                            <button *ngIf="( ['companyListOfIServiceCategoryPage', 'showTradeTablePage', 'investorFinderPage', 'investeeFinderPage'].includes(thisPage) && showDeleteFromListButton )" pButton type="button" [disabled]="selectedCompany?.length == 0" label="Delete From List" icon="ui-icon-delete" class="p-button-sm p-button-rounded p-button-danger mr-2" (click)="deleteCompanyFromList(adminRecordListTable, thisPage)"></button>

                            <ng-container *ngIf="[ 'corporateRiskPage', 'investorFinderPage', 'investeeFinderPage', 'diversityCalculation', 'supplierResilience'].includes(thisPage) || ([ 'diversityInclusion' ].includes( thisPage ) && listId) ">

                                <button pButton *ngIf="( userAuthService.isLoggedInSubject$ | async ) && ( thisPage == 'diversityCalculation' || thisPage == 'supplierResilience')" type="button" class="p-button-rounded p-button-sm mr-2" (click)="goToStatsPage('localStatsScreen')" label="Local Stats " icon="pi pi-chart-line" [disabled]="listDataValues && listDataValues?.length === 0"></button>

                                <button pButton *ngIf="( userAuthService.isLoggedInSubject$ | async )" type="button" class="p-button-rounded p-button-sm" (click)="goToStatsPage('statsScreen')" label="Stats" icon="pi pi-chart-line" [disabled]="listDataValues && listDataValues?.length === 0"></button>

                                <button type="button" *ngIf="( userAuthService.isLoggedInSubject$ | async ) && selectedGlobalCountry == 'uk'" pButton class="p-button-rounded p-button-sm ml-2 bg-blue-600"  label="Growth Anaysis" icon="pi pi-chart-line" (click)="goToStatsPage('growthAnaysis')" [disabled]="listDataValues && listDataValues?.length === 0"></button>
                            </ng-container>
                            <ng-container *ngIf="[ 'diversityCalculation', 'supplierResilience' ].includes(thisPage)">
                                <button pButton class="ui-button-inline ui-button-sm p-button-sm ml-3" type="button" label="Progress Report" (click)="goToDiversityProgressReport(thisPage)"></button>
                            </ng-container>

                        </div>
                        
                        <div *ngIf="searchTotalCount >= 5000 && ![ 'showChargesTablePage', 'buyerNonRegPage', 'supplierNonRegPage', 'suppliersDashboard', 'supplierDashboard', 'contractFinderPage', 'buyersDashboard', 'investeeFinderPage', 'investorFinderPage', 'corporateRiskPage', 'hnwiPage', 'ppcPage', 'showContactScreen', 'promptSearchAi' ].includes(thisPage)" class="c-light font-italic">
                            <ng-container *ngIf="selectedGlobalCountry == 'uk'">
                                <ng-container *ngIf="this.userAuthService.hasAddOnPermission('developerFeatures'); else other">
                                    <small>( *Note : Max 10,000 records can be exported.)</small>
                                </ng-container>
                                <ng-template #other>
                                    <small>( *Note : Max 5,000 records can be exported.)</small>
                                </ng-template>
                            </ng-container>
                        </div>

                        <div *ngIf="searchTotalCount >= messageCountForTable && [ 'showChargesTablePage'].includes(thisPage)" class="c-light font-italic">
                            <small>( *Note : Max {{messageCountForTable}} records can be exported and 1000 can be added in list. )</small>
                        </div>
                    </div>

                    <ng-container *ngIf="![ 'netZero', 'webWidgetPage', 'overviewLinkedinProfile', 'promptSearchAi' ].includes( thisPage )">
                        <div class="col-12" *ngIf="userDetails?.isSubscriptionActive">
                            <p-paginator *ngIf="isPaginatorVisible && !this.userDetails.isTrial" #recordListPaginator [first]="first" [rows]="rows" [totalRecords]="( thisPage === 'user-management' ) ? tableInputValues.tableDataValues.total :  tableInputValues.tableDataValues.totalSearchedRecords ? tableInputValues.tableDataValues.totalSearchedRecords : recordsCount" [rowsPerPageOptions]="[ 'showChargesTablePage', 'companyListOfIServiceCategoryPage', 'customerWatchPage', 'showTradeTablePage', 'user-management' ].includes( thisPage ) ? [25,50,100] : ![ 'showDirectorScreenPage', 'showContactScreen' ].includes( thisPage ) ? [25, 50, 100] : '' " (onPageChange)="pageChange($event, adminRecordListTable)" [alwaysShow]="( searchTotalCount && searchTotalCount >= 25 ) || ( totalNoOfRecords && totalNoOfRecords >= 25 ) || ( totalSearchedRecords && totalSearchedRecords >= 25 ) || ( tableInputValues.tableDataValues.total && tableInputValues.tableDataValues.total >= 25 )"></p-paginator>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="thisPage == 'promptSearchAi'">
                        <div class="col-12" *ngIf="userDetails?.isSubscriptionActive">
                            <p-paginator #recordListPaginator [first]="first" [rows]="rows" [totalRecords]="searchTotalCount > 10000 ? 10000 : searchTotalCount" [rowsPerPageOptions]="[25,50,100]" (onPageChange)="pageChange($event, adminRecordListTable)"></p-paginator>
                        </div>
                    </ng-container>
                </div>
            </ng-template>

            <ng-template pTemplate="header" let-columns>
                <tr class="headerStyle">
                    <th style="min-width: 35px; max-width: 35px;" *ngIf="[ 'customerWatchPage', 'update-user', 'companyListOfIServiceCategoryPage', 'showChargesTablePage', 'showDirectorScreenPage', 'user-management', 'investeeFinderPage', 'investorFinderPage', 'showContactScreen', 'esgWatchPage', 'buyersDashboard', 'contractFinderPage', 'hnwiPage', 'suppliersDashboard', 'diversityInclusion', 'showTradeTablePage', 'webWidgetPage', 'promptSearchAi' ].includes( thisPage )">
                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                    </th>

                   
                    <th *ngFor="let col of columns" [ngStyle]="{ 'min-width': col.minWidth, 'max-width': col.maxWidth, 'text-align': col.textAlign }"
                        [hidden]="col.field == 'id' || ( [ 'fullySatisfiedCount', 'person_entile_fully' ].includes( col.field ) && showExportFilterBtn )"
                        [pSortableColumn]="['companyRegistrationNumber', 'ethnic_share_percentage', 'female_founded', 'female_owned_share_percentage', 'vcseCategory', 'share_holders_count', 'active_director_count', 'age_director_diversity', 'company_number', 'is_ethnic_minority', 'internationalScoreDescription', 'isNetZeroTarget', 'net-zero_target', 'isPpcCertification', 'isRaceAtWork', 'company_status', 'msmeCategory', 'isEthnicOwnership', 'femaleOwned', 'isMilitaryVeteran', 'isVcseCategory', 'companyName', 'application_date', 'telephone_number', 'awardedValue', 'contractStartDate', 'contractEndDate', 'procurementStage', 'procurementType', 'locationOfContract', 'cpvCode', 'department', 'entity', 'paymentDate', 'expenseType', 'expenseArea', 'supplierName', 'supplierSitePostCode', 'transactionNumber', 'paymentDescription', 'total', 'businessName', 'benchmarking', 'investedCompany', 'ccjCounts', 'noOfActiveDirectors', 'activeCharges', 'propertyCount', 'last12YearExportCount', 'last12YearImportCount', 'grant', 'governmentProcurment', 'lastAccountFiled', 'supplierReference' ].includes(col.field) && ['companyListOfIServiceCategoryPage', 'diversityInclusion', 'diversityCalculation', 'ppcPage', 'contractFinderPage', 'payments', 'supplierResilience'].includes(thisPage) ? '' : [ 'companyListOfIServiceCategoryPage', 'diversityInclusion', 'diversityCalculation', 'showDirectorScreenPage', 'user-management', 'customerWatchPage' ].includes(thisPage) ? col.field : [ 'user-management', 'customerWatchPage', 'showDirectorScreenPage', 'showContactScreen', 'esgWatchPage', 'supplierNonRegPage', 'buyerNonRegPage', 'bibyFinanceAccountSearch' ].includes( thisPage ) ? '' : [ 'turnover', 'person_entile_outs', 'classification', 'tagNameField', 'chargeTagsName', 'dateMonthCount', 'dateMonthCountForRegOn', 'netWorth', 'RegAddress', 'website', 'otherFeatures', 'telephone', 'ctps', 'sicCode07', 'region', 'directorName', 'pscNameFd', 'total_shareholding', 'companyAge','companyRegistrationNumber','supplierAddress','constituency','county','ward','cpv_codes','postcode','country','total_contract_presented','suppliers_count', 'lastFiveYearExports', 'lastOneYearExports', 'lastFiveYearImports', 'lastOneYearImports', 'exportAmount', 'exchangeRateEffect', 'businessName', 'industryTag', 'NumMortCharges', 'turnover_latest', 'numberOfEmployees', 'estimated_turnover', 'totalAssets_latest', 'totalLiabilities_latest', 'netWorth_latest', 'grossProfit_latest', 'numShareHolder', 'shareholdingInformation', 'industryArray', 'credibility', 'internationalScoreDescription', 'fullName', 'job_title', 'companyName', 'companyStatus', 'outstandingCount', 'personEntitledGroup', 'companyDOIAgeForCharges', 'closing_date', 'title', 'suppliersName', 'contract_start_date', 'contract_end_date', 'cpv_codes_tree', 'awarded_value', 'supplierName', 'cpvCodes', 'total_contracts_published_value', 'regions', 'awardStatus', 'code_desc_key' ].includes( col.field ) && thisPage != 'ppcPage' ? '' : col.field"  [style.display]="['showChargesTablePage','customerWatchPage','showDirectorScreenPage','showContactScreen', 'showTradeTablePage'].includes(thisPage) && !col.visible ? 'none' : ''">
    
                        <ng-container *ngIf="thisPage == 'showDirectorScreenPage'; else otherHeaders">
                            <ng-container
                                *ngIf="col.header == 'Status'; else OtherDirectorHeaders">
                                {{col.header}} <i class="pi pi-info-circle" (mouseenter)="op2.show($event)"
                                    (mouseleave)="op2.hide($event)" style="font-size:18px"></i>
                                <p-overlayPanel #op2 [showCloseIcon]="false" [dismissable]="true" appendTo="body">
                                    <span class="featuresLinks">
                                        <div>
                                            <i class="ui-icon-lens green"></i> Active
                                        </div>
                                        <div>
                                            <i class="ui-icon-lens red"></i> Resigned
                                        </div>
                                        <div>
                                            <i class="ui-icon-lens c-light"></i> Inactive
                                        </div>
                                    </span>
                                </p-overlayPanel>
                            </ng-container>
                            <ng-container *ngIf="col.header == 'CTPS Registered'">
                                <sup><b>*</b></sup>
                            </ng-container> 
                            <ng-template #OtherDirectorHeaders>
                                {{col.header}}
                            </ng-template>
                        </ng-container>
                        <ng-template #otherHeaders>
                            {{col.header}}
                            
                            <ng-container *ngIf="col.header == 'CTPS Registered'">
                                <sup><b>*</b></sup>
                            </ng-container>
                        </ng-template>

                        <ng-container *ngIf="![ 'showContactScreen', 'esgWatchPage', 'supplierNonRegPage', 'buyerNonRegPage', 'supplierDashboard', 'webWidgetPage', 'promptSearchAi' ].includes( thisPage ) ">
                            <ng-container *ngIf="![ 'companyListOfIServiceCategoryPage', 'customerWatchPage', 'supplierResilience' ].includes( thisPage ); else defaultSort ">
                                <p-sortIcon [field]="col.field" *ngIf="![ 'person_entile_outs', 'classification', 'tagNameField', 'chargeTagsName', 'dateMonthCount', 'turnover', 'netWorth', 'RegAddress', 'website', 'otherFeatures', 'telephone', 'ctps', 'sicCode07', 'region', 'directorName', 'pscNameFd', 'editDetails', 'notification', 'filedDate', 'registrationDate', 'directorEmail', 'directorLinkedIn', 'Website', 'companyAge', 'industryTag', 'NumMortCharges', 'CCJCount', 'numberOfEmployees', 'turnover_latest', 'estimated_turnover', 'totalAssets_latest', 'totalLiabilities_latest', 'netWorth_latest', 'grossProfit_latest', 'status', 'numShareHolder', 'total_shareholding', 'edit', 'shareHoldingDissolvedCount','shareholdingInformation','industryArray','plan_name', 'subs_startDate', 'subs_endDate', 'isEmailVerified', 'logInTime', 'phoneNumber', 'director_name', 'occupation', 'phone_no', 'email_id', 'directorAge', 'directorAddress' , 'appointed_date', 'directorShipActive', 'directorShipTotal', 'job_title', 'credibility', 'changeToClient', 'clientUsersCount', 'referredData', 'esgCurrentPercentage', 'esgPreviousPercentage', 'eCurrentPercentage', 'ePreviousPercentage', 'sCurrentPercentage','sPreviousPercentage', 'gCurrentPercentage','gPreviousPercentage','carbonCurrentTotal','carbonPreviousTotal','closing_time','closing_date','title','notice_identifier','suppliers','cpv_codes','published_date','suitablefor','companyRegistrationNumber','supplierAddress','country','constituency','county','ward','region_array','postcode', 'cpvCodes', 'regions', 'awardStatus', 'contract_end_date', 'awarded_value', 'total_contracts_published_value', 'contract_start_date', 'internationalScoreDescription','cpv_codes_tree','companyDOIAgeForCharges', 'dateMonthCountForRegOn', 'outstandingCount','total_contract_presented','suppliers_count', 'suppliersName', 'noOfLoginDevices', 'teamName', 'ethnic_share_percentage', 'female_founded', 'age_director_diversity', 'female_owned_share_percentage', 'is_ethnic_minority', 'share_holders_count', 'active_director_count', 'plan_type_latest', 'subs_duration', 'exportAmount', 'exchangeRateEffect', 'internationalScoreDescription', 'businessName', 'vcseCategory', 'lastOneYearExports', 'lastFiveYearExports', 'lastOneYearImports', 'lastFiveYearImports', '', 'company_number', 'isNetZeroTarget', 'net-zero_target', 'isPpcCertification', 'isRaceAtWork', 'company_status', 'msmeCategory', 'isEthnicOwnership', 'femaleOwned', 'isMilitaryVeteran', 'isVcseCategory', 'code_desc_key', 'militaryVeterans', 'companyName', 'application_date', 'telephone_number', 'awardedValue', 'contractStartDate', 'contractEndDate', 'procurementStage', 'procurementType', 'locationOfContract', 'cpvCode', 'buyer_name', 'department', 'entity', 'paymentDate', 'expenseType', 'expenseArea', 'supplierName', 'supplierSitePostCode', 'transactionNumber', 'paymentDescription', 'total' ].includes( col.field ) || (thisPage != 'ppcPage' &&  col.field =='company_name')"></p-sortIcon>
                            </ng-container>
    
                            <ng-template #defaultSort>
                                <p-sortIcon [field]="col.field" *ngIf="![ 'person_entile_outs', 'classification', 'tagNameField','chargeTagsName', 'dateMonthCount', 'dateMonthCountForRegOn', 'turnover', 'netWorth', 'RegAddress', 'website', 'otherFeatures', 'telephone', 'ctps', 'sicCode07', 'region', 'directorName', 'pscNameFd', 'editDetails', 'notification', 'filedDate', 'registrationDate', 'directorEmail', 'directorLinkedIn', 'Website', 'companyAge','industryTag', 'NumMortCharges', 'CCJCount', 'numberOfEmployees', 'turnover_latest', 'estimated_turnover', 'totalAssets_latest', 'totalLiabilities_latest', 'netWorth_latest', 'grossProfit_latest', 'status', 'numShareHolder', 'total_shareholding', 'edit', 'shareHoldingDissolvedCount','shareholdingInformation','industryArray','plan_name', 'subs_startDate', 'subs_endDate', 'isEmailVerified', 'logInTime', 'phoneNumber', 'credibility', 'internationalScoreDescription', 'outstandingCount','companyRegistrationNumber','supplierAddress','constituency','county','ward','cpv_codes','postcode','country','total_contract_presented','suppliers_count', 'noOfLoginDevices', 'code_desc_key', 'benchmarking', 'investedCompany', 'ccjCounts', 'noOfActiveDirectors', 'activeCharges', 'propertyCount', 'last12YearExportCount', 'last12YearImportCount', 'grant', 'governmentProcurment', 'lastAccountFiled', 'businessName', 'companyRegNum', 'msmeCategory', 'isEthnicOwnership', 'femaleOwned', 'isMilitaryVeteran', 'colSupplierNumbers' ].includes( col.field )"></p-sortIcon>
                            </ng-template>
                        </ng-container>

                        <ng-container *ngIf="col.header == 'Features'">
                            <i class="pi pi-info-circle" (mouseenter)="op2.show($event)" (mouseleave)="op2.hide($event)" style="font-size:18px"></i>
                            <p-overlayPanel #op2 [showCloseIcon]="false" [dismissable]="true" appendTo="body">

                                <ng-conatiner *ngIf="['showDirectorScreenPage', 'showContactScreen'].includes(thisPage); else defaultFeatureInfoIcons">
                                    
                                    <ng-container *ngIf="thisPage == 'showContactScreen'">
                                        <span class="featuresIconsOnHover">
                                            <div>
                                                <span class="material-icons c-blue">email</span><span class="ml-1 c-blue font-medium">Email</span>
                                            </div>
                                            <div>
                                                <span class="material-icons">
                                                    <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg></span><span class="ml-1 font-medium" style="color: #0077b5;">LinkedIn</span>
                                            </div>
                                            <div>
                                                <span class="material-icons c-green">language</span><span class="ml-1 c-green font-medium">Company Website</span>
                                            </div>
                                            <div>
                                                <span class="material-icons c-blue">people</span><span class="ml-1 c-blue font-medium">Director</span>
                                            </div>
                                            <!-- <div>git 
                                                <span class="material-icons c-darkBlue">people</span><span class="ml-1 c-darkBlue font-medium">Possible Director</span>
                                            </div> -->
                                            <div>
                                                <span class="material-icons c-green">supervisor_account</span><span class="ml-1 c-green font-medium">PSC</span> 
                                            </div>
                                           
                                            <div>
                                                <span class="material-icons c-voilet">people_alt</span><span class="ml-1 c-voilet font-medium">Shareholder</span>
                                            </div>
                                            <div>
                                                <span class="material-icons c-yellow">emoji_events</span><span class="ml-1 c-yellow font-medium">Highest Shareholder</span>
                                            </div>
                                            <div>
                                                <span class="material-icons c-orange">workspace_premium</span><span class="ml-1 c-orange font-medium">Second Highest Shareholder</span>
                                            </div>
                                        </span>
                                    </ng-container>

                                    <ng-container *ngIf="thisPage == 'showDirectorScreenPage'">

                                        <span class="featuresIconsOnHover">
                                            <!-- <div>
                                                <span class="material-icons c-green mb-1">language</span><span class="ml-1 c-green font-medium">Website</span>
                                            </div> -->
                                            <div>
                                                <span class="material-icons c-blue mb-1">email</span><span class="ml-1 mb-1 c-blue font-medium">Email</span>
                                            </div>
                                            <div>
                                                <span class="material-icons">
                                                    <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path
                                                            d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                    </svg>
                                                </span>
                                                <span class="ml-1 font-medium" style="color: #0077b5;">LinkedIn</span>
                                            </div>
                                            <div>
                                                <span class="material-icons c-darkBlue mt-1 mb-2">people</span><span class="ml-1 mb-2 c-darkBlue font-medium">Total Directorships Count</span>
                                            </div>

                                        </span>
                                    </ng-container>

                                </ng-conatiner>

                                

                                <ng-template #defaultFeatureInfoIcons>
                                    <span class="featuresLinks">
                                        <ng-container *ngIf="thisPage == 'webWidgetPage'; else other"> 
                                            <div>
                                                <i class="material-icons mb-1">phone</i><span class="ml-1">Phone</span>
                                            </div>
                                            <div>
                                                <i class="material-icons mb-1">language</i><span class="ml-1">Website</span>
                                            </div>
                                            <div>
                                                <a>

                                                    <svg class="linkedin" xmlns="http://www.w3.org/2000/svg"
                                                        viewBox="0 0 512 512">
                                                        <path
                                                            d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                    </svg>
                                                </a> <span class="ml-1">LinkedIn</span>
                                            </div>
                                        </ng-container>
                                        <ng-template #other>
                                            <div>
                                                <a>
                                                    <img tooltip="Search on google"
                                                        src="https://img.icons8.com/color/48/000000/google-logo.png"
                                                        id="google-image">
                                                </a> <span class="ml-1">Google</span>
                                            </div>
                                            <div>
                                                <a>
            
                                                    <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path
                                                            d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                    </svg>
                                                </a> <span class="ml-1">LinkedIn</span>
                                            </div>
                                            <div>
                                                <i class="material-icons">insert_drive_file</i><span class="ml-1">Notes</span>
                                            </div>
                                        </ng-template>
                                    </span>
                                </ng-template>

                            </p-overlayPanel>
                        </ng-container>
                        

                        <ng-container *ngIf="col.header == 'Turnover (Estimate+)' && thisPage != 'webWidgetPage'">
                            <i class="pi pi-info-circle" (mouseenter)="op2.show($event)" (mouseleave)="op2.hide($event)"
                                style="font-size:18px"></i>
                            <p-overlayPanel #op2 [showCloseIcon]="false" [dismissable]="true" appendTo="body">
                                <div class="OverlayAdmin">
                                    <strong>Estimated Turnover</strong> = 7.3 times Trade Debtors.				
                                </div>
                            </p-overlayPanel>
                            <!-- <dg-shared-toolTip [iTagMessage]="iTagMessage" ></dg-shared-toolTip> -->
                        </ng-container>
                        <ng-container *ngIf="col.header == 'Turnover' && thisPage == 'webWidgetPage'">
                            <i class="pi pi-info-circle" (mouseenter)="op2.show($event)" (mouseleave)="op2.hide($event)"
                                style="font-size:18px"></i>
                            <p-overlayPanel #op2 [showCloseIcon]="false" [dismissable]="true" appendTo="body">
                                <div class="OverlayAdmin pb-2">
                                    <i class="pi pi-circle-fill pr-2" style="color: #1ab394;"></i><strong>Turnover</strong>						
                                </div>
                                <div class="OverlayAdmin">
                                    <i class="pi pi-circle-fill pr-2" style="color: #03a9f4;"></i><strong>Estimated Turnover (*)</strong>						
                                </div>
                            </p-overlayPanel>
                        </ng-container>

                        <ng-container *ngIf="col.header == 'Director\'s by Age'">
                            <i class="pi pi-info-circle" (mouseenter)="op2.show($event)" (mouseleave)="op2.hide($event)" style="font-size:18px"></i>
                            <p-overlayPanel #op2 [showCloseIcon]="false" [dismissable]="true" appendTo="body">

                                <div class="gaugeLegends ml-auto">
                                    <div class="below30">
                                        <span class="colorBlock"></span>
                                        <span class="label">Below 30</span>
                                    </div>
                                    <div class="container30To50">
                                        <span class="colorBlock"></span>
                                        <span class="label">31 to 50</span>
                                    </div>
                                    <div class="container50To65">
                                        <span class="colorBlock"></span>
                                        <span class="label">51 to 65</span>
                                    </div>
                                    <div class="above65">
                                        <span class="colorBlock"></span>
                                        <span class="label">Above 65</span>
                                    </div>
                                </div>

                            </p-overlayPanel>
                        </ng-container>

                    </th>
                </tr>
                <tr class="filterSearchRow" *ngIf="![ 'update-user', 'customerWatchPage', 'companyListOfIServiceCategoryPage', 'showContactScreen', 'esgWatchPage', 'webWidgetPage', 'payments' ].includes( thisPage ) && ( ( [ subscribedPlanModal['Monthly_Expand'], subscribedPlanModal['Expand_Annual_One_Year'], subscribedPlanModal['Expand_Annual_Two_Year'], subscribedPlanModal['Expand_New_Monthly'], subscribedPlanModal['Monthly_Expand_Paid_Test'], subscribedPlanModal['Monthly_Enterprise'], subscribedPlanModal['Enterprise_Annual_One_Year'], subscribedPlanModal['Enterprise_Annual_Two_Year'], subscribedPlanModal['Enterprise_New_Monthly'], subscribedPlanModal['Monthly_Enterprise_Paid_Test'], subscribedPlanModal['Annually_Expand'], subscribedPlanModal['Annually_Enterprise'], subscribedPlanModal['Enterprise_Conversion_For_Ravi'], subscribedPlanModal['Premium_New_Monthly'], subscribedPlanModal['Premium_Annual_One_Year'], subscribedPlanModal['Premium_Annual_Two_Year'], subscribedPlanModal['Valentine_Special'], subscribedPlanModal['Expand_Weekly_Trial'], subscribedPlanModal['Monthly_Expand_Trial'], subscribedPlanModal['Annually_Expand_Trial'], subscribedPlanModal['Enterprise_Weekly_Trial'], subscribedPlanModal['Monthly_Enterprise_Trial'], subscribedPlanModal['Annually_Enterprise_Trial'] ].includes( userDetails?.planId ) && userDetails?.isSubscriptionActive ) || userAuthService.hasRolePermission( ['Super Admin'] ) )">
                    <th *ngIf="[ 'customerWatchPage','update-user', 'companyListOfIServiceCategoryPage', 'showChargesTablePage', 'showDirectorScreenPage', 'user-management','investorFinderPage', 'investeeFinderPage', 'showContactScreen', 'esgWatchPage', 'buyersDashboard','contractFinderPage', 'hnwiPage', 'suppliersDashboard', 'diversityInclusion' ].includes( thisPage )" style="min-width: 35px; max-width: 35px;">
                    </th>
                    <ng-container *ngIf="!['supplierNonRegPage', 'buyerNonRegPage', 'supplierDashboard','showTradeTablePage', 'overviewLinkedinProfile', 'promptSearchAi'].includes( thisPage )">
                        <th *ngFor="let col of columns" [ngStyle]="{ 'min-width': col.minWidth, 'max-width': col.maxWidth, 'text-align': col.textAlign }" [ngSwitch]="col.field"
                            [hidden]="col.field == 'id' || ( [ 'fullySatisfiedCount', 'person_entile_fully' ].includes( col.field ) && showExportFilterBtn )" [style.display]="['showChargesTablePage','customerWatchPage','showDirectorScreenPage','showContactScreen', 'showTradeTablePage'].includes(thisPage) && !col.visible ? 'none' : ''">
                            <ng-container *ngIf="!['supplierNonRegPage', 'buyerNonRegPage', 'supplierDashboard', 'webWidgetPage', 'promptSearchAi'].includes( thisPage )">
                                <input pInputText type="text" placeholder="Search Keyword" (input)="applyFilter($event, adminRecordListTable, col.field, 'contains')"
                                    [value]="adminRecordListTable.filters[ col.field ]?.value"
                                    [hidden]="[ 'editDetails', 'notification', 'sicCode07', 'otherFeatures', 'directorName', 'edit', 'userExportListDownload', 'userReportListDownload', 'otherRelations', 'download', 'commentaryImpact', 'safealertdescription','userSuggestionUpdate', 'notification', 'updatePlanDetails', 'deleteExportList', 'deletePdfReportList', 'add_On', 'chipData', 'natures_of_control', 'sicCode07', 'person_entile_updated', 'dataOfBirth', 'person_entile_outs', 'classification', 'tagNameField', 'chargeTagsName', 'dateMonthCount', 'pscNameFd', 'telephone', 'website', 'ctps', 'RegAddress', 'phone_no', 'ctps', 'email_id', 'total_shareholding', 'status', 'region', 'shareHoldingsCount', 'directorEmail', 'directorLinkedIn', 'Website', 'industryTag', 'numShareHolder','companyStatus', 'phoneNumber', 'plan_name', 'subs_startDate', 'subs_endDate', 'isEmailVerified', 'logInTime', 'shareHoldingLiveCount', 'shareHoldingDissolvedCount', 'shareholdingInformation', 'industryArray', 'shareHoldingsCountLive', 'shareHoldings', 'credibility', 'directorShipTotal', 'directorShipActive', 'job_title', 'directorAddress' ,'clientUsersCount', 'referredData','closing_date', 'title', 'suppliers', 'published_date', 'suitablefor', 'contract_end_date', 'awarded_value', 'companyRegistrationNumber', 'supplierAddress', 'country', 'constituency', 'county', 'ward', 'cpv_codes', 'region_array', 'postcode', 'cpvCodes', 'awardStatus', 'regions', 'contract_start_date','cpv_codes_tree', 'dateMonthCountForRegOn', 'outstandingCount', 'companyAge', 'suppliersName', 'noOfLoginDevices', 'changeToClient', 'teamName', 'ethnic_share_percentage', 'age_director_diversity', 'female_owned_share_percentage', 'plan_type_latest', 'subs_duration', 'fullySatisfiedCount', 'companyDOIAgeForCharges', 'lastFiveYearExports', 'lastOneYearExports', 'lastFiveYearImports', 'lastOneYearImports', 'exportAmount', 'exchangeRateEffect', 'militaryVeterans', 'code_desc_key', 'awardedValue', 'contractStartDate', 'contractEndDate', 'procurementStage', 'procurementType', 'locationOfContract', 'cpvCode', 'buyer_name', 'department', 'entity', 'paymentDate', 'expenseType', 'expenseArea', 'supplierName', 'supplierSitePostCode', 'transactionNumber', 'paymentDescription', 'total', 'benchmarking', 'investedCompany', 'ccjCounts', 'noOfActiveDirectors', 'activeCharges', 'propertyCount', 'last12YearExportCount', 'last12YearImportCount', 'grant', 'governmentProcurment', 'lastAccountFiled', 'turnover', 'supplierReference' ].includes( col.field ) || (thisPage == 'ppcPage' &&  col.field =='companyName') || ( ['businessName', 'companyRegNum', 'colSupplierNumbers'].includes(col.field) && thisPage == 'supplierResilience')" *ngSwitchDefault (keypress)="validateSearchField($event, col.field)">
                                    <span *ngIf="col.field == tempField && showInputFieldMessage == true" style="color: red;">
                                        <small style="float: left;">
                                            Please enter value according to the field.
                                        </small>
                                    </span>
                            </ng-container>
    
                            <p-calendar id="companyRegDatePick" #companyRegDatePicker [monthNavigator]="true" [yearNavigator]="true"
                                [numberOfMonths]="1" [maxDate]="todayDate" yearRange="1900:{{maxYear}}" placeholder="dd-mm-yyyy"
                                [(ngModel)]="companyRegDatePickValue" appendTo="body" [baseZIndex]="999999998" selectionMode="range"
                                dateFormat="dd-mm-yy" *ngSwitchCase="'companyRegistrationDate'"
                                (onSelect)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'companyRegDatePickFilters')">
                            </p-calendar>
                            
                            <ng-container *ngIf="[ 'companiesColumnListForTable' ].includes( thisPage )">
                                <p-multiSelect id="customerWatchOptions" [options]="customerWatchOptions" [(ngModel)]="customerWatchModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'companyStatus'" selectedColumnsLabel="{0} companyStatus selected" defaultLabel="Choose Status" (ngModelChange)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true > </p-multiSelect>
                            </ng-container>

                            <p-multiSelect id="ethnicMinorityOptions" [options]="ethnicMinorityOptions" [(ngModel)]="ethnicMinorityModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'is_ethnic_minority'" selectedColumnsLabel="{0} is_ethnic_minority selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isEthnicOwnership" [options]="trueFalseOptions" [(ngModel)]="isEthnicOwnershipModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isEthnicOwnership'" selectedColumnsLabel="{0} isEthnicOwnership selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="value" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isMilitaryVeteran" [options]="trueFalseOptions" [(ngModel)]="isMilitaryVeteranModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isMilitaryVeteran'" selectedColumnsLabel="{0} isMilitaryVeteran selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="value" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="femaleOwned" [options]="trueFalseOptions" [(ngModel)]="femaleOwnedModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'femaleOwned'" selectedColumnsLabel="{0} femaleOwned selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="value" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isVcseCategory" [options]="trueFalseOptions" [(ngModel)]="isVcseCategoryModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isVcseCategory'" selectedColumnsLabel="{0} isVcseCategory selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="value" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isNetZeroTargetModel" [options]="trueFalseOptions" [(ngModel)]="isNetZeroTargetModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isNetZeroTarget'" selectedColumnsLabel="{0} is Net-zero target selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="value" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="net-zero_target" [options]="trueFalseOptionsBooleanPPC" [(ngModel)]="net_zero_targetModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'net-zero_target'" selectedColumnsLabel="{0} is Net-zero target selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isPpcCertification" [options]="trueFalseOptionsBooleanPPC" [(ngModel)]="isPpcCertificationModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isPpcCertification'" selectedColumnsLabel="{0} is PPC certification" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="isRaceAtWork" [options]="trueFalseOptionsBooleanPPC" [(ngModel)]="isRaceAtWork_Model" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'isRaceAtWork'" selectedColumnsLabel="{0} is Race To Work" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="msmeCategory" [options]="msmeCategoryOptions" [(ngModel)]="msmeCategoryModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'msmeCategory'" selectedColumnsLabel="{0} msmeCategory selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="internationalScoreDescription" [options]="internationalScoreDescriptionOptions" [(ngModel)]="internationalScoreDescriptionModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'internationalScoreDescription'" selectedColumnsLabel="{0} internationalScoreDescription selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminReorcdListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="companyStatusArray" [options]="companyStatusArray" [(ngModel)]="companyStatusModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'company_status'" selectedColumnsLabel="{0} companyStatus" defaultLabel="Choose Status" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="founderByOptions" [options]="founderByOptions" [(ngModel)]="founderByOptionsModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'female_founded'" selectedColumnsLabel="{0} female_founded selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>

                            <p-multiSelect id="VCSEByOptions" [options]="vcseByOptions" [(ngModel)]="founderByModel" appendTo="body" [baseZIndex]="999999998" *ngSwitchCase="'vcseCategory'" selectedColumnsLabel="{0} vcseCategory selected" defaultLabel="Choose Value" [filter]="true" [showToggleAll]="false" optionLabel="label" optionValue="value" filterBy="label" (ngModelChange)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'in')" (focus)="fetchTableData(adminRecordListTable)" resetFilterOnHide=true ></p-multiSelect>
        
                            <p-calendar id="incorporationDatePick" #incorporationDatePicker [monthNavigator]="true"
                                [yearNavigator]="true" [numberOfMonths]="1" [maxDate]="todayDate" yearRange="1900:{{maxYear}}"
                                placeholder="dd-mm-yyyy" [(ngModel)]="incorporationDatePickValue" appendTo="body"
                                [baseZIndex]="999999998" selectionMode="range" dateFormat="dd-mm-yy"
                                *ngSwitchCase="'IncorporationDate'"
                                (onSelect)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'incorporationDatePickFilters')">
                            </p-calendar>
        
                            <p-calendar id="accountmadeUpDatePick" #accountmadeUpDatePicker [monthNavigator]="true"
                                [yearNavigator]="true" [numberOfMonths]="1" [maxDate]="todayDate" yearRange="1900:{{maxYear}}"
                                placeholder="dd-mm-yyyy" [(ngModel)]="accountmadeUpDatePickValue" appendTo="body"
                                [baseZIndex]="999999998" selectionMode="range" dateFormat="dd-mm-yy" *ngSwitchCase="'lastmade'"
                                (onSelect)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'accountmadeUpDatePickFilters')">
                            </p-calendar>
                            
                            <p-calendar id="appointedDatePicker" #appointedDataPicker [monthNavigator]="true"
                                [yearNavigator]="true" [numberOfMonths]="1" [maxDate]="todayDate" yearRange="1900:{{maxYear}}"
                                placeholder="dd-mm-yyyy" [(ngModel)]="appointedDataPickValue" appendTo="body"
                                [baseZIndex]="999999998" dateFormat="dd-mm-yy" *ngSwitchCase="'appointed_date'"
                                (onSelect)="applyFilter($event, adminRecordListTable, col.field, col.filterMatchMode, 'appointedDataPickFilters')">
                            </p-calendar>
        
                        </th>
                    </ng-container>
                </tr>
            </ng-template>

            <ng-template #getCompanyDetailScrollPosition pTemplate="body" let-rowIndex="rowIndex" let-rowData let-columns="columns">

                <tr [pSelectableRow]="rowData" [ngClass]="{ 'heighlightTableRow': ( thisPage == 'customerWatchPage' && rowData['customerNotification'] ), 'disolvedCompanyRow' : ( ( thisPage == 'customerWatchPage' || thisPage == 'cbilPage' ) && rowData['companyStatus'] == 'dissolved' && !( thisPage == 'customerWatchPage' && rowData['customerNotification'] ) ), 'clientUserRow': ( thisPage == 'user-management' && rowData['userRole'] == 'Client Admin Master' && userAuthService.hasRolePermission( ['Super Admin'] ) ) }" [pReorderableRow]="index">

                    <td *ngIf="[ 'customerWatchPage', 'companyListOfIServiceCategoryPage', 'showChargesTablePage', 'showDirectorScreenPage', 'user-management', 'update-user', 'investeeFinderPage', 'investorFinderPage', 'showContactScreen', 'esgWatchPage', 'buyersDashboard','contractFinderPage', 'hnwiPage', 'suppliersDashboard', 'diversityInclusion', 'showTradeTablePage', 'webWidgetPage', 'promptSearchAi' ].includes( thisPage )" [ngClass]="{ 'd-lg-table-cell hidden': thisPage == 'customerWatchPage' }" style=" min-width: 35px; max-width: 35px;">
                        <ng-container *ngIf="( ['suppliersDashboard', 'buyersDashboard', 'contractFinderPage'].includes(thisPage) )">
                            <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                        </ng-container>
                        <ng-container *ngIf="!['suppliersDashboard', 'buyersDashboard', 'contractFinderPage'].includes(thisPage)">
                            <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                        </ng-container>
                    </td>

                    <td *ngFor="let col of columns" [ngStyle]="{ 'min-width': col.minWidth, 'max-width': col.maxWidth, 'text-align': col.textAlign, 'vertical-align': col.verticalAlign }" [hidden]="col.field == 'id' || ( [ 'fullySatisfiedCount', 'person_entile_fully' ].includes( col.field ) && showExportFilterBtn )" [ngSwitch]="true" [style.display]="['showChargesTablePage','customerWatchPage','showDirectorScreenPage','showContactScreen', 'showTradeTablePage'].includes(thisPage) && !col.visible ? 'none' : ''">

						<span *ngIf="col.field != 'notification'" class="p-column-title">{{ col.header }}:</span>

                        <ng-container *ngSwitchCase="col.field == 'editDetails'">
                            <button pButton type="button" icon="pi pi-pencil" class="mr-2 p-button-rounded p-button p-button-lg" (click)="editCbilsDetails(rowData)"></button>&nbsp;
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'companyDOIAgeForCharges'">
                            {{ rowData[col.field]}}
                        </ng-container>
                        <ng-container *ngSwitchCase="col.field == 'businessAlphaName'">
                            {{ rowData[col.field]}}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'spendNet'">
                            <ng-container *ngIf="rowData[col.field] && rowData[col.field] < 0; else positiveValue">
                                ( {{ rowData[col.field] ? ( -1 * rowData[col.field] | currency: 'GBP' : 'symbol': '1.0-0' ) : '-' }} )
                            </ng-container>
                            <ng-template #positiveValue>
                                {{ rowData[col.field] ? ( rowData[col.field] | currency: 'GBP' : 'symbol': '1.0-0' ) : '-' }}
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'directorAddress'">
                        
                          {{ directorAddress(rowData[col.field]) ? directorAddress(rowData[col.field]) : '-' }}
                            
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'teamName', 'female_founded', 'is_ethnic_minority', 'female_founded', 'vcseCategory', 'fullName', 'procurementType', 'militaryVeterans' ].includes( col.field )">
                            {{ ( rowData[col.field] ? ( rowData[col.field] | titlecase ) : '-' ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'notification'">
                            <ng-container *ngIf="thisPage == 'customerWatchPage'; else notifyIconForOtherPages">
                                <a href="javascript: void(0);" (click)="turnOffNotification( rowData )">
                                    <strong><span [ngStyle]="{ color:'var( --text-color )' }" class="p-column-title inline-block lg:hidden font-bold">Notification:</span></strong><i class="material-icons" [ngClass]="{ 'c-red': rowData['customerNotification'], 'c-light': !rowData['customerNotification'] }">{{ ( rowData['customerNotification'] ) ? 'notifications_active' : 'notifications_none' }}</i>
                                </a>
                            </ng-container>
                            <ng-template #notifyIconForOtherPages>
                                <a href="javascript: void(0);">
                                    <i class="material-icons c-light">notifications_none</i>
                                </a>
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="['company_contact_info_latest'].includes(col.field)">
                            <span class="featuredLinks">
                                <ng-container
                                    *ngIf="rowData?.company_contact_info_latest && rowData?.company_contact_info_latest?.telephone && rowData?.company_contact_info_latest?.telephone !== 'null'">
                                    <a href="javascript:void(0);" title="phone">
                                        <i class="material-icons">phone</i>
                                    </a>
                                </ng-container>
    
                                <ng-container
                                    *ngIf="rowData?.company_contact_info_latest && rowData?.company_contact_info_latest?.website && rowData?.company_contact_info_latest?.website !== 'null'">
                                    <a href="javascript:void(0);" title="Website">
                                        <i class="material-icons">language</i></a>
                                </ng-container>
    
                                <span addOnAccess="contactInformation">
                                    <ng-container
                                        *ngIf="( rowData?.company_contact_info_latest && rowData?.company_contact_info_latest?.linkedin_url != '' )">
    
                                        <ng-container
                                            *ngIf="rowData?.company_contact_info_latest && rowData?.company_contact_info_latest?.linkedin_url">
                                            <a target="_blank" [href]="rowData?.company_contact_info_latest?.linkedin_url">
                                                <svg class="linkedin" xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg>
                                            </a>
                                        </ng-container>
                                    </ng-container>
                                </span>
                            </span>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'companyNumber'">

                            <ng-container *ngIf="thisPage == 'buyersDashboard'; else forOtherPages">
                                <ng-container *ngIf="rowData['buyerName'] && rowData['companyRegistrationNumber']; else elseBlock">
                                    <a class="cName " target="_blank" href="javascript:void(0)" [routerLink]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase)">{{ rowData[col.field] | uppercase }}</a>
                                </ng-container>
                                <ng-template #elseBlock>
                                    {{ ( rowData[col.field] ? rowData[col.field] : '-' ) | uppercase }}
                                </ng-template>
                            </ng-container>
                            
                            <ng-template #forOtherPages>
                                <a class="cName" target="_blank"
                                    [href]="'/company/' + rowData['companyNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">
                                    {{ rowData[col.field] | uppercase }}</a>
                            </ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'companyName'">
                            
                            <ng-container *ngIf="![ 'showContactScreen' ].includes( thisPage )">
                                <span class="companyLogoAlign" *ngIf="rowData?.logo_url; else noCompanyLogo">
                                    <img class="companyLogoSize" *ngIf="rowData?.logo_url" src="{{ rowData?.logo_url }}" alt="Company Logo" />
                                </span>
        
                                <ng-template #noCompanyLogo>
                                    <span>
                                        <i class="material-icons c-blue">business</i>
                                    </span>
                                </ng-template>
                            </ng-container>
    
                            <ng-container *ngIf="[ 'showDirectorScreenPage', 'showContactScreen', 'esgWatchPage', 'ppcPage' ].includes( thisPage ); else otherPage">

                                <a class="cName ml-2 hidden xl:inline" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['companyName'] | titlecase)" (click)="showCompanySideDetailsPanel($event, rowData['companyRegistrationNumber'], rowData[ col.field ])">{{ rowData[col.field] | uppercase }}</a>

                                <a class="cName ml-2 inline xl:hidden" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['companyName'] | titlecase)">{{ rowData[col.field] | uppercase }}</a>

                            </ng-container>
    
                            <ng-template #otherPage>
                                <a class="cName ml-2" target="_blank"
                                    [href]="'/company/' + rowData['companyNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">{{
                                    rowData['businessName'] | uppercase }}
                                </a>
                                <span class="infoName hidden lg:inline" (mouseover)="showCompanyQuickInfoPopover($event, rowData)" (mouseout)="hideCompanyQuickInfoPopover()">
                                    <i class="pi pi-info-circle"></i>
                                </span>
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'Company Name'">
                            <span *ngIf="rowData[col.field]; else other">
                                <i class="material-icons c-blue">business</i>
                            </span>
                            <ng-container *ngIf="rowData['Company Number']; else noLinkBlock">
                                <a class="cName ml-2" target="_blank" [href]="'/company/' + rowData['Company Number'] + '/' + formatCompanyNameForUrl(rowData['Company Name'] | titlecase)">{{ rowData['Company Name'] | uppercase }}
                                </a>
                            </ng-container>
                            <ng-template #noLinkBlock><span class="ml-2">{{ rowData['Company Name'] | uppercase }}</span></ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'Company Number'">
                            <a class="cName ml-2" target="_blank" [href]="'/company/' + rowData['Company Number'] + '/' + formatCompanyNameForUrl(rowData['Company Name'] | titlecase)">{{
                            rowData['Company Number'] ? rowData['Company Number'] : '-' }}
                            </a>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'linkedinPersonName'">
                            <a target="_blank" [href]="rowData['linkedein_url']">
                                <svg class="linkedin linkdinHeightforSearchChargeTable" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                    <path
                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                </svg>
                            </a>
                            <strong>{{ rowData[col.field] | titlecase }}</strong>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'businessName'">
                            <span class="companyLogoAlign" *ngIf=" rowData?.companyContactDetails && rowData?.companyContactDetails.logo; else noCompanyLogo">
                                <ng-container *ngIf="!rowData?.companyContactDetails.logo.includes('https://static'); else noCompanyLogo">
                                    <img class="companyLogoSize" src="{{ rowData?.companyContactDetails.logo }}" alt="Company Logo" />
                                </ng-container>
                            </span>
                            <ng-template #noCompanyLogo>
                                <span *ngIf="rowData[col.field]; else other">
                                    <i class="material-icons c-blue">business</i>
                                </span>
                                <ng-template #other>-</ng-template>
                            </ng-template>
    
                            <span class="ml-2">

                                <ng-container *ngIf="thisPage == 'esgWatchPage'; else otherBlock">

                                    <a class="cName" target="_blank" [href]="'/company/' + rowData['companyNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">
                                    {{ rowData[col.field] | uppercase }}</a>

                                </ng-container>

                                <ng-template #otherBlock>
                                    <ng-container *ngIf="thisPage == 'webWidgetPage'">
                                        <a class="cName ml-1 hidden xl:inline"
                                        href="javascript:void(0)"
                                            (click)="showCompanySideDetailsPanel($event, rowData['companyRegistrationNumber'], rowData['businessName'] )">{{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-container>

                                    <ng-container *ngIf="thisPage == 'diversityCalculation' || thisPage == 'supplierResilience'">
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegNum'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">
                                        {{ rowData[col.field] | uppercase }}</a>
                                    </ng-container>

                                    <ng-container *ngIf="thisPage == 'customerWatchPage'">
                                        <a class="cName" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData[ col.field ] | titlecase)" target="_blank">{{ rowData[col.field] | uppercase }}</a>
                                    </ng-container>

                                    <ng-container *ngIf="!['webWidgetPage', 'diversityCalculation', 'customerWatchPage', 'supplierResilience'].includes(thisPage)">
                                        <a class="cName hidden xl:inline" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData[ col.field ] | titlecase)" (click)="showCompanySideDetailsPanel($event, rowData['companyRegistrationNumber'], rowData[ col.field ])">{{ rowData[col.field] | uppercase }}</a>
        
                                        <a class="cName inline xl:hidden" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)"> {{ rowData[col.field] | uppercase }}</a>
                                    </ng-container>

                                </ng-template>

                                <span addOnAccess="contactInformation"> 
                                    <ng-container *ngIf="thisPage == 'showChargesTablePage'">                               
                                        <ng-container
                                            *ngIf="(rowData?.companyContactDetails && rowData?.companyContactDetails?.linkedin_url && rowData?.companyContactDetails?.linkedin_url !== '0' && rowData?.companyContactDetails?.linkedin_url !== ' ' && rowData?.companyContactDetails?.linkedin_url !== 'null') || (rowData?.RegAddress_Modified && rowData?.RegAddress_Modified?.linkedin_url && rowData?.RegAddress_Modified?.linkedin_url !== '0' && rowData?.RegAddress_Modified?.linkedin_url !== ' ' && rowData?.RegAddress_Modified?.linkedin_url !== 'null'); else noLinkedinURLCompany">

                                            <ng-container *ngIf="rowData?.companyContactDetails && rowData?.companyContactDetails?.linkedin_url && rowData?.companyContactDetails?.linkedin_url !== '0' && rowData?.companyContactDetails?.linkedin_url !== ' ' && rowData?.companyContactDetails?.linkedin_url !== 'null'; else otherBlock">
                                                <a target="_blank" [href]="rowData.companyContactDetails.linkedin_url">
                                                    <svg class="linkedin linkdinHeightforSearchChargeTable" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path
                                                            d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                    </svg>
                                                </a>
                                            </ng-container>
                                            <ng-template #otherBlock>
                                                <ng-container *ngIf="rowData?.RegAddress_Modified && rowData?.RegAddress_Modified?.linkedin_url && rowData?.RegAddress_Modified?.linkedin_url !== '0' && rowData?.RegAddress_Modified?.linkedin_url !== ' ' && rowData?.RegAddress_Modified?.linkedin_url !== 'null'">
                                                    <a target="_blank" [href]="rowData.RegAddress_Modified.linkedin_url">
                                                        <svg class="linkedin linkdinHeightforSearchChargeTable" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                            <path
                                                                d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                        </svg>
                                                    </a>
                                                </ng-container>
                                            </ng-template>

                                        </ng-container>
        
                                        <ng-template #noLinkedinURLCompany>
                                            <a href="javascript: void(0);"
                                                (click)="checkSubscriptionAuth( true, linkedinURLForCompany(rowData.businessName) )">
                                                <svg class="svg-fill-light linkdinHeightforSearchChargeTable" xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg>
                                            </a>
                                        </ng-template>
                                    </ng-container>
                                </span>
                                
                            </span>
    
                            <ng-container *ngIf="thisPage == 'showChargesTablePage'">
                                <a [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData[ col.field ] | titlecase) + '?type=viewCharges' " target="_blank"><span class="inColumnLinkRight"><i class="material-icons valign-m">account_balance</i> Charges</span></a>
                            </ng-container>
    
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'company_number' ].includes( col.field )">
                                <a class="cName" target="_blank" [href]="'/company/' + rowData['company_number'] + '/' + formatCompanyNameForUrl(rowData['company_name'] | titlecase)">{{ rowData[col.field] | uppercase }}</a>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'net-zero_target', 'isPpcCertification', 'isRaceAtWork' ].includes( col.field )">
                            {{ rowData[col.field] == 'True' ? 'Yes' : 'No' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'company_name' ].includes( col.field )">
                            <ng-container *ngIf="this.thisPage != 'ppcPage'; else other">
                                <div class="flex flex-wrap justify-content-between">
                                    
                                    <div>
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['company_number'] + '/' + formatCompanyNameForUrl(rowData['company_name'] | titlecase)">{{ rowData[col.field] | uppercase }}</a>
                                        
                                        <span class="msdukCertified" *ngIf="rowData['msduk_certification']">
                                            <img src="assets/layout/images/msduk_certified.png" alt="MSDUK Certified" width="20">
                                        </span>
    
                                        <span class="bcorpCertified" *ngIf="rowData['bcorp_certification']">
                                            <img src="assets/layout/images/b_corp_certified.png" alt="B Corp Certified">
                                        </span>
    
                                    </div>
    
                                    <div>
                                        <ng-container *ngIf="rowData[ 'company_status' ] && rowData[ 'company_status' ].length; else noRecord">
                                            <span [ngClass]="{ 'green':  rowData[ 'company_status' ] == 'live' || rowData[ 'company_status' ] == 'administration order', 'c-orange':  rowData[ 'company_status' ] == 'in liquidation' || rowData[ 'company_status' ] == 'removed', 'c-red': rowData[ 'company_status' ] == 'converted/closed' || rowData[ 'company_status' ] == 'dissolved' || rowData[ 'company_status' ] == 'in administration' || rowData[ 'company_status' ] == 'in receivership / administration' ||  rowData[ 'company_status' ] == 'voluntary arrangement' || rowData[ 'company_status' ] == 'in receivership' || rowData[ 'company_status' ] == 'deleted'}" class="status">{{ rowData[ 'company_status' ] ? ( rowData[ 'company_status' ] | titlecase ) : '' }}
                                            </span>
                                        </ng-container>
                                        <ng-template #noRecord>
                                            -
                                        </ng-template>
                                    </div>
    
                                </div>
                            </ng-container>
                            <ng-template #other>
                                <ng-container *ngIf="thisPage == 'ppcPage'">
                                    {{ rowData[col.field] | uppercase }}
                                </ng-container>
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'companyRegistrationNumber'">

                            <ng-container *ngIf="![ 'buyerNonRegPage', 'supplierNonRegPage', 'suppliersDashboard', 'supplierDashboard', 'buyersDashboard' ].includes(thisPage)">
                                
                                <ng-container *ngIf="rowData['companyName']; else otherBlock">
                                    <a class="cName pl-2" target="_blank"
                                        [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['companyName'] | titlecase)">
                                        {{ rowData[col.field] | uppercase }}</a>
                                </ng-container>

                                <ng-template #otherBlock>
                                    <ng-container *ngIf="rowData['businessName'];else other">
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">
                                        {{ rowData[col.field] | uppercase }}</a>
                                    </ng-container>
                                    <ng-template #other>
                                        -
                                    </ng-template>
                                </ng-template>

                            </ng-container>

                            <ng-container *ngIf="thisPage == 'buyersDashboard'">
                                <ng-container *ngIf="rowData['companyStatus'] == 'dissolved'; else secondBlock">
                                    {{ rowData[col.field] | uppercase }}
                                </ng-container>

                                <ng-template #secondBlock>
                                    <ng-container *ngIf="rowData['companyRegistrationNumber']?.length >= 10; else redirectToRespectiveTab">
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?companyType=isBuyer'">
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-container>
    
                                    <ng-template #redirectToRespectiveTab>
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?businessType=viewGovernmentEnablerBuyer'">
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-template>
                                </ng-template>
                            </ng-container>

                            <ng-container *ngIf="thisPage == 'suppliersDashboard'">
                                <ng-container *ngIf="rowData['companyStatus'] == 'dissolved'; else secondBlock">
                                    {{ rowData[col.field] | uppercase }}
                                </ng-container>

                                <ng-template #secondBlock>
                                    <ng-container *ngIf="rowData['companyRegistrationNumber']?.length >= 10; else redirectToRespectiveTab">
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?companyType=isSupplier'">                                           
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-container>

                                    <ng-template #redirectToRespectiveTab>
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?businessType=viewGovernmentEnablerSupplier'">                                         
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-template>
                                </ng-template>

                            </ng-container>

                            <ng-container *ngIf="thisPage == 'supplierNonRegPage'">
                                <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['supplier_name'] | titlecase) + '?type=isSupplier'">
                                    {{ rowData[col.field] | uppercase }}
                                </a>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'companyRegNum'">
                            <ng-container *ngIf=" [ rowData['isGovtDepts'],  rowData['isCouncil'], rowData['isUniversity'] ].includes('True'); else clickable">
                                {{ rowData[col.field] | uppercase }}
                            </ng-container>
                            <ng-template #clickable>
                                <a class="cName pl-2" target="_blank" [href]="'/company/' + rowData['companyRegNum'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase)">
                                {{ rowData[col.field] | uppercase }}</a>
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'CountryCode', 'Country', 'City'].includes(col.field)">
                            <ng-container *ngIf="col.field == 'CountryCode'; else noCountryCode">
                                <span> <img src="assets/utilities/flags/flag_placeholder.png" alt="Flag" class="flag flag-{{  rowData[col.field] | lowercase }}"> </span>
                            </ng-container>
                            <ng-template #noCountryCode>
                                {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="['IPAddress'].includes(col.field)">
                            <a href="javascript:void(0)" class="cName ml-1 hidden xl:inline" (click)="ipAddress(rowData[col.field])">
                                {{ ( rowData[col.field] ? rowData[col.field] : '-' ) }}
                            </a>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="[ 'buyer_name', 'supplier_name', 'buyerName' ].includes(col.field)">

                            <ng-container *ngIf="[ 'buyersDashboard', 'suppliersDashboard', 'contractFinderPage' ].includes( thisPage )">

                                <ng-container *ngIf="thisPage == 'contractFinderPage' && (rowData['buyerName'] || rowData['buyer_name']) && (rowData['organisationReg'] || rowData['customOrganisationReg'])">
                                    {{ rowData[ col.field ] | uppercase }}
                                </ng-container>

                                <ng-container *ngIf="thisPage == 'buyersDashboard'">
                                    <ng-container *ngIf="rowData['companyStatus'] == 'dissolved'; else buyerLink">
                                        {{ rowData[col.field] | uppercase }}
                                    </ng-container>
                                    <ng-template #buyerLink>
                                        <a *ngIf="rowData['companyRegistrationNumber']?.length >= 10; else buyerAltLink" class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?companyType=isBuyer'">
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                        <ng-template #buyerAltLink>
                                            <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?businessType=viewGovernmentEnablerBuyer'">
                                                {{ rowData[col.field] | uppercase }}
                                            </a>
                                        </ng-template>
                                    </ng-template>
                                </ng-container>

                                <ng-container *ngIf="thisPage == 'suppliersDashboard'">
                                    <a *ngIf="rowData['companyRegistrationNumber']?.length >= 10; else supplierAltLink" class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['supplier_name'] | titlecase) + '?companyType=isSupplier'">
                                        {{ rowData[col.field] | uppercase }}
                                    </a>
                                    <ng-template #supplierAltLink>
                                        <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['supplier_name'] | titlecase) + '?businessType=viewGovernmentEnablerSupplier'">
                                            {{ rowData[col.field] | uppercase }}
                                        </a>
                                    </ng-template>
                                </ng-container>

                                <ng-container *ngIf="!rowData[col.field]">
                                    -
                                </ng-container>
                            </ng-container>
                        
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'suppliersName'">

                            <ng-container *ngIf="rowData['suppliers'] && rowData['suppliers']?.length; else noSupplierName">

                                <div #descriptionTextContainer class="limitTextHeight">
                                    <ng-container *ngFor="let item of rowData['suppliers']; let i = index">
										<ng-container *ngIf="i < 4">
											<ng-container *ngIf="item['name'] && item['customSupplierReg']">
                                                <span>
                                                    <a class="cName" target="_blank"
                                                    [href]="'/company/' + item['customSupplierReg'] + '/' + formatCompanyNameForUrl(item['name'] | titlecase) + '?companyType=isSupplier'">
                                                        {{ item['name'] | uppercase }}
                                                    </a>
                                                </span>
                                            </ng-container>

                                            <ng-container *ngIf="item['name'] && item['supplierReg']">
                                                <span> <a class="cName" target="_blank" [href]="'/company/' + item['supplierReg'] + '/' + formatCompanyNameForUrl(item['name'] | titlecase) + '?companyType=isSupplier'">
                                                        {{ item['name'] | uppercase }}
                                                    </a>
                                                </span>
                                            </ng-container>
                                            <ng-container *ngIf="rowData['suppliers']?.length && ( i < rowData['suppliers']?.length - 1 ) && i < 3">, <br></ng-container>
										</ng-container>
									</ng-container>
                                </div>
                                <a type="button" *ngIf="rowData['suppliers']?.length > 2 || rowData['suppliers'][0]['name']?.length > 30" href="javascript:void(0);"
                                    class="small-data-font c-green" (click)="showText(descriptionTextContainer)">Read More</a>

                            </ng-container>
                            <ng-template #noSupplierName>-</ng-template>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'supplierName'">
                            <ng-container *ngIf="rowData['supplierName'] && rowData['companyRegistrationNumber']; else otherBlock">

                                <ng-container *ngIf="rowData['supplierName'] && rowData['companyRegistrationNumber'] && rowData['companyRegistrationNumber']?.length < 10">
                                    <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?businessType=viewGovernmentEnablerSupplier'">
                                        {{ rowData[col.field] | uppercase }}
                                    </a>
                                </ng-container>
    
                                <ng-container *ngIf="rowData['supplierName'] && rowData['companyRegistrationNumber'] && rowData['companyRegistrationNumber']?.length >= 10">
                                    <a class="cName" target="_blank" [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?companyType=isSupplier'">
                                        {{ rowData[col.field] | uppercase }}
                                    </a>
                                </ng-container>
                                
                            </ng-container>

                            <ng-container *ngIf="!rowData['supplierName']">
                                -
                            </ng-container>
                            <ng-template #otherBlock>
                                {{ rowData[col.field] | uppercase }}
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="[ 'industryType', 'supplier_address', 'supplierAddress', 'ojeu_contract_type' ].includes(col.field)">
                            {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'about_me' ].includes(col.field)">
                            <div [dgReadMore]="true" [numberOfLines]="1">
                                {{ resetString ( rowData[col.field] ? rowData[col.field] : '-' ) }} <!-- resetString function will convert First character to Uppercase -->
                            </div>
                        </ng-container>

                        <ng-container *ngIf="thisPage == 'contractFinderPage'; else otherPages">

                            <ng-container *ngSwitchCase="col.field == 'contract_status' || col.field == 'procurementStage' || col.field == 'locationOfContract'">
                                {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                            </ng-container>

                            <ng-container *ngSwitchCase="[ 'region_array'].includes( col.field )">
                                <span>
                                    <ng-container *ngIf="rowData[col.field]?.length > 0; else noRegionArray">
                                        {{ rowData[col.field].toString() | titlecase }}
                                    </ng-container>
                                </span>
                            </ng-container>

                        </ng-container>
                        <ng-template #otherPages>
                            <ng-container *ngSwitchCase="[ 'region_array', 'contractType', 'status', 'regions' ].includes( col.field )">
                                <ng-container *ngIf="rowData[col.field]?.length > 0; else noRegionArray">
                                    {{ formattedCamelCaseToSentence(rowData[col.field].toString()) | titlecase}}
                                </ng-container>
                                
                                <ng-container *ngIf="rowData[col.field]?.length > 0 && rowData[col.field] == ''">
                                    Unknown
                                </ng-container>
                            </ng-container>
                        </ng-template>

                        <ng-container *ngIf="thisPage == 'suppliersDashboard'">
							<ng-container *ngSwitchCase="[ 'isSME', 'isVCSE' ].includes( col.field )">
								<ng-container *ngIf="(rowData[col.field] && rowData[col.field] == true); else elseBlock">Yes</ng-container>
								<ng-template #elseBlock>No</ng-template>
							</ng-container>
						</ng-container>

                        <ng-container *ngSwitchCase="col.field == 'awardStatus'">                            
                            <div>
                                <strong>Awarded :</strong> {{ rowData['awardStatus']['awarded'] ? rowData['awardStatus']['awarded'] : 0 }}
                            </div>
                            <div>
                                <strong>Closed :</strong> {{ rowData['awardStatus']['closed'] ? rowData['awardStatus']['closed'] : 0 }}
                            </div>
                            <div>
                                <strong>Open :</strong> {{ rowData['awardStatus']['open'] ? rowData['awardStatus']['open'] : 0 }}
                            </div>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'organisationReg'">
                            <ng-container *ngIf="rowData['organisationReg']; else customOrganisationReg">
                                <a class="cName" target="_blank" [href]="'/company/' + rowData['organisationReg'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?businessType=viewGovernmentEnablerBuyer'">
                                    {{ ( rowData[col.field] ? rowData[col.field] : '-' ) | uppercase }}
                                </a>
                            </ng-container>
                            <ng-template #customOrganisationReg>
                                <a class="cName" target="_blank" [href]="'/company/' + rowData['customOrganisationReg'] + '/' + formatCompanyNameForUrl(rowData['buyer_name'] | titlecase) + '?companyType=isBuyer'">
                                    {{ rowData['customOrganisationReg'] | uppercase }}
                                </a>
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'person_entile_outs'">
    
                            <ng-container *ngIf="rowData['person_entile_partial']">
                                <ng-container *ngFor="let partial of rowData['person_entile_partial']">
                                    <span class="badge badge-yellow badge-round">
                                        {{ partial }}
                                        <span class="infoName"
                                            (mouseover)="showPersonOutstandingData($event, rowData.chargesData, partial)"
                                            (mouseout)="hideOutstandingonHoverData()">
                                            <i class="pi pi-info-circle"></i>
                                        </span>
                                    </span>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="rowData[col.field]!= ''">
                                <ng-container *ngFor="let prop of rowData[col.field]">
                                    <span class="badge badge-red badge-round">
                                        {{ prop }}
                                        <span class="infoName"
                                            (mouseover)="showPersonOutstandingData($event, rowData.chargesData, prop)"
                                            (mouseout)="hideOutstandingonHoverData()">
                                            <i class="pi pi-info-circle"></i>
                                        </span>
                                    </span>
                                </ng-container>
                            </ng-container>
    
                            <span
                                *ngIf="!rowData['person_entile_outs'] || rowData['person_entile_outs'] == '' || rowData['person_entile_outs'] == undefined || rowData['person_entile_outs'] == null">{{
                                '-' }}</span>
                            <span
                                *ngIf="!rowData['person_entile_partial'] || rowData['person_entile_partial'] == '' || rowData['person_entile_partial'] == undefined || rowData['person_entile_partial'] == null">{{
                                '' }}</span>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'industryTag'">
                            {{ rowData[col.field] | titlecase }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'person_entile_fully'">
                            <ng-container *ngIf="rowData[col.field]!= ''">
                                <ng-container *ngFor="let prop of rowData[col.field]">
                                    <span class="badge badge-primary badge-round">
                                        {{ prop }}
                                    </span>
                                </ng-container>
                            </ng-container>
                            <span *ngIf="!rowData['person_entile_fully'] || rowData['person_entile_fully'] == ''">{{ '-'
                                }}</span>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'isEthnicOwnership', 'femaleOwned', 'isMilitaryVeteran', 'isVcseCategory', 'isNetZeroTarget' ].includes(col.field)">
                            {{ rowData[col.field] == 'False' ? 'No' : "Yes" }}
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="[ 'dateMonthCount', 'dateMonthCountForRegOn' ].includes(col.field)">
                            <ng-container *ngIf="rowData[col.field]!= ''">
                                <ng-container *ngFor="let month of rowData[col.field]">
                                    <span>
                                        <ul class="badge badge-purple badge-round listStyle">
                                            <li>{{ month }}</li>
                                        </ul>
                                    </span>
                                </ng-container>
                            </ng-container>
                            <span *ngIf="!rowData[col.field] || rowData[col.field] == ''">{{ '-' }}</span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'classification'">
                            <ng-container *ngIf="rowData[col.field] != ''">
                                <ng-container *ngFor="let charges of rowData[col.field]">
                                    <span>
                                        <ul class="badge badge-blue badge-round listStyle">
                                            <li>{{ charges }}</li>
                                        </ul>
                                    </span>
                                </ng-container>
                            </ng-container>
                            <span *ngIf="!rowData['classification'] || rowData['classification'] == ''">{{ '-' }}</span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'sicCode07'">
                            <ng-container *ngIf="getSICCodeInArrayFormat(rowData[col.field]!==undefined && rowData[col.field])?.length; else noSicCodeAvailable">
                                <span *ngFor="let item of getSICCodeInArrayFormat(rowData[col.field])">
                                    {{ item | titlecase }}
                                </span>
                            </ng-container>
                            <ng-template #noSicCodeAvailable>Not Provided</ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'tagNameField'">
                            <ng-container *ngIf="rowData[col.field] != ''">
                                <span *ngFor="let tag of rowData[col.field]">
                                    <span class="badge badge-primary badge-round">
                                        {{ tag }}
                                    </span>
                                </span>
                            </ng-container>
                            <span *ngIf="!rowData['tagNameField'] || rowData['tagNameField'] == ''">{{ '-' }}</span>
                        </ng-container>
                        <ng-container *ngSwitchCase="col.field == 'chargeTagsName'">
                            <ng-container *ngIf="rowData[col.field] != ''">
                                <span *ngFor="let tag of rowData[col.field]">
                                    <span class="badge badge-primary badge-round">
                                        {{ tag | titlecase}}
                                    </span>
                                </span>
                            </ng-container>
                            <span *ngIf="!rowData['chargeTagsName'] || rowData['chargeTagsName'] == ''">{{ '-' }}</span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'otherFeatures'">
                            <span class="featuredLinks">

                                <ng-container *ngIf="thisPage !== 'showDirectorScreenPage'">

                                    <a href="javascript: void(0);"
                                        (click)="checkSubscriptionAuth( true, GoogleURLCompanyURLwithoutWordCompany(rowData.businessName) )"
                                        *ngIf="rowData.businessName">
                                        <img tooltip="Search on google"
                                            src="https://img.icons8.com/color/48/000000/google-logo.png" id="google-image">
                                    </a>
                                    <span addOnAccess="contactInformation">
                                    <!-- <ng-container *ngIf="( userAuthService.hasAddOnPermission('contactInformation') || userAuthService.hasRolePermission( ['Super Admin'] ) )"> -->
                                        <ng-container *ngIf="rowData?.companyContactDetails && rowData?.companyContactDetails?.linkedin_url && rowData?.companyContactDetails?.linkedin_url !== '0' && rowData?.companyContactDetails?.linkedin_url !== ' ' && rowData?.companyContactDetails?.linkedin_url !== 'null' || ( rowData?.RegAddress_Modified && rowData?.RegAddress_Modified.linkedin_url ) ; else noLinkedinURLCompany">

                                            <ng-container *ngIf="rowData?.companyContactDetails && rowData?.companyContactDetails?.linkedin_url; else otherBlock">
                                                <a target="_blank" [href]="rowData.companyContactDetails.linkedin_url">
                                                    <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                    </svg>
                                                </a>
                                            </ng-container>
                                            <ng-template #otherBlock>
                                                <ng-container *ngIf="rowData?.RegAddress_Modified && rowData?.RegAddress_Modified.linkedin_url">
                                                    <a target="_blank" [href]="rowData.RegAddress_Modified.linkedin_url">
                                                        <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                            <path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                        </svg>
                                                    </a>
                                                </ng-container>
                                            </ng-template>
                                        </ng-container>

                                        <ng-template #noLinkedinURLCompany>
                                            <a href="javascript: void(0);"
                                                (click)="checkSubscriptionAuth( true, linkedinURLForCompany(rowData.businessName) )">
                                                <svg class="svg-fill-light" xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg>
                                            </a>
                                        </ng-template>
                                    <!-- </ng-container> -->
                                    </span>

                                </ng-container>

                                <ng-container *ngIf="thisPage == 'showDirectorScreenPage'">

                                    <!-- <span>
                                        <a href="javascript:void(0);" title="Website" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'AboutComponent', 'classForContactInfo' )">
                                            <i class="material-icons mr-2 c-green">language</i></a>
                                    </span> -->
                        

                                    <span *ngIf="rowData.email_id">
                                            <a href="javascript:void(0);" title="Email" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                                <i class="material-icons mr-3 c-blue">email</i></a>
                                    </span>
                                
                                    <!-- <a href="javascript: void(0);"
                                        (click)="checkSubscriptionAuth( true, GoogleURLCompanyURLwithoutWordCompany(rowData.director_name) )"
                                        *ngIf="rowData.director_name">
                                        <img tooltip="Search on google" src="https://img.icons8.com/color/48/000000/google-logo.png" id="google-image">
                                    </a> -->
                                
                                    <ng-container
                                        *ngIf="rowData?.linkedin_url && rowData?.linkedin_url !== '0' && rowData?.linkedin_url !== ' ' && rowData?.linkedin_url !== 'null'; else noLinkedinURLDirector">
                                        <ng-container *ngIf="rowData.linkedin_url.includes('https://') ; else otherBlock">
                                            <a href="javascript:void(0);" title="LinkedIn" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                                <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg>
                                            </a>
                                        </ng-container>
                                        <ng-template #otherBlock>
                                            <a href="javascript:void(0);" title="LinkedIn" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                                <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path
                                                        d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                                </svg>
                                            </a>
                                        </ng-template> 
                                    </ng-container>
                                
                                    <!-- <ng-template #noLinkedinURLDirector>
                                        <a href="javascript: void(0);"
                                            (click)="checkSubscriptionAuth( true, linkedinURLForCompany(rowData.director_name) )">
                                            <svg class="svg-fill-light" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                <path
                                                    d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                            </svg>
                                        </a>
                                    </ng-template> -->


                                    

                                    <span *ngIf="rowData.directorShipTotal" >
                                        <a href="javascript:void(0);" title="Total Directorships Count" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                            <i class="material-icons ml-1 c-darkBlue">people</i></a>
                                    </span>
                                 
                                </ng-container>

                                <span *ngIf="thisPage != 'showDirectorScreenPage'">

                                    <a [href]="'/company/' + rowData['companyRegistrationNumber'] + '/' + formatCompanyNameForUrl(rowData['businessName'] | titlecase) + '?type=viewNotes' "  target="_blank" title="Notes"><i class="material-icons">insert_drive_file</i></a>

                                </span>
                            </span>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'otherFeaturesForEmails'">
                            <span class="featuresIconsOnHover">
                                <span *ngIf="rowData.email">
                                    <a href="javascript:void(0);" title="Email" (click)="showDilog( rowData )">
                                        <i class="material-icons ml-1 c-blue">email</i></a>
                                </span>
                                <!-- <span *ngIf="rowData.email">
                                    <a href="javascript:void(0);" title="Email" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'PersonContactInfoComponent' )">
                                        <i class="material-icons ml-1 c-blue">email</i></a>
                                </span> -->

                                <ng-container class="ml-1" *ngIf="rowData?.fullName && rowData?.linkedin_url && rowData?.linkedin_url !== '0' && rowData?.linkedin_url !== ' ' && rowData?.linkedin_url !== 'null'">
                                    <a class="ml-1" href="javascript:void(0);" title="LinkedIn" (click)="showDilog( rowData )" >
                                        <svg class="linkedin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path
                                                d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
                                        </svg></a>
								</ng-container>

                                <ng-container *ngIf="rowData?.website && rowData?.fullName">
                                    <span>
                                        <a href="javascript:void(0);" title="Company Website" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewAboutCompany', 'classForContactInfo' )">
                                            <i class="material-icons ml-1 c-green">language</i></a>
                                    </span>
                                </ng-container>

                                <span *ngIf="rowData.isDirector">
                                    <a href="javascript:void(0);" title="Director" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                        <i class="material-icons ml-1 c-blue">people</i></a>
                                </span>

                                <span *ngIf="rowData.isPossibleDirector" >
                                    <a href="javascript:void(0);" title="Possible Director" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewDirectors' )">
                                        <i class="material-icons ml-1 c-darkBlue">people</i></a>
                                </span>

                                <span *ngIf="rowData.isPsc">
                                    <a href="javascript:void(0);" title="PSC" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewPsc' )">
                                        <i class="material-icons ml-1 c-green">supervisor_account</i></a>
                                </span>

                                <span *ngIf="rowData.isShareholder">
                                    <a href="javascript:void(0);" title="Shareholders" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewShareholders' )">
                                        <i class="material-icons ml-1 c-voilet">people_alt</i></a>
                                </span>

                                <span *ngIf="rowData.isHighestShareholder">
                                    <a href="javascript:void(0);" title="Highest Shareholder" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewShareholders' )">
                                        <i class="material-icons ml-1 c-yellow">emoji_events</i></a>
                                </span>

                                <span *ngIf="rowData.isSecondHighestShareholder">
                                    <a href="javascript:void(0);" title="Second Highest Shareholder" (click)="showCompanySideDetailsPanel( $event, rowData['companyRegistrationNumber'], rowData['businessName'], undefined, 'viewShareholders' )">
                                        <i class="material-icons ml-1 c-orange">workspace_premium</i></a>
                                </span>

                                <!-- <span *ngIf="rowData.isHighestShareholder" class="material-icons ml-1 c-yellow" title="Highest Shareholder">emoji_events</span>

                                <span *ngIf="rowData.isSecondHighestShareholder" class="material-icons ml-1 c-orange" title="Second Highest Shareholder">workspace_premium</span> -->

                                <!-- <span *ngIf="rowData.isPsc" class="material-icons ml-1 c-green" title="PSC">supervisor_account</span> -->
                                <!-- <span *ngIf="rowData.isDirector" class="material-icons ml-1 c-blue" title="Director">people</span> -->
                                <!-- <span *ngIf="rowData.isShareholder" class="material-icons ml-1 c-voilet" title="Shareholders">people_alt</span> -->
                            </span>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'website'">
                            <span *ngIf="rowData['website'] && rowData['website'] != ''">
                                <strong>
                                    <a target="_blank" href="javascript:void(0)" class="cName"
                                        href="http://www.{{formatWebsite(rowData['website'])}}">{{
                                        formatWebsite(rowData['website']) }}</a>
                                </strong>
                            </span>
                            <span *ngIf="!rowData['website'] || rowData['website'] == ''"><strong>{{ '-' }}</strong></span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'telephone'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userAuthService.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                <span *ngIf="rowData['telephone'] && rowData['telephone'] != ''">{{ rowData['telephone']  }}</span>
                                <span *ngIf="!rowData['telephone'] || rowData['telephone'] == ''">{{ '-' }}</span>
                            </ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'ctps'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userAuthService.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                <ng-container *ngIf="['customerWatchPage'].includes( thisPage ); else otherPage">
                                    <ng-container *ngIf="rowData[col.field] && rowData.companyContactInformation && rowData.companyContactInformation.tel_1; else otherBlock">
                                        <span
                                            [ngClass]="{ 'c-red': rowData[col.field] == 'y', 'green': ( !rowData[col.field] || rowData[col.field] !== 'y') }"
                                            class="status">
                                            {{rowData.ctps == 'y' ? 'Yes' : 'No' }}
                                        </span>
                                    </ng-container>
                                    <ng-template #otherBlock>
                                        <ng-container *ngIf="rowData[col.field] && rowData.RegAddress_Modified && rowData.RegAddress_Modified.telephone; else noCtps">
                                            <span
                                                [ngClass]="{ 'c-red': rowData[col.field] == 'y', 'green': ( !rowData[col.field] || rowData[col.field] !== 'y') }"
                                                class="status">
                                                {{rowData.ctps == 'y' ? 'Yes' : 'No' }}
                                            </span>
                                        </ng-container>
                            
                                    </ng-template>
                            
                                </ng-container>
                                <ng-template #otherPage>
                                    <span *ngIf="rowData[col.field] && rowData.telephone; else noCtps"
                                        [ngClass]="{ 'c-red': rowData[col.field] == 'y', 'green': ( !rowData[col.field] || rowData[col.field] !== 'y') }"
                                        class="status">
                                        {{rowData.ctps == 'y' ? 'Yes' : 'No' }}
                                    </span>
                                </ng-template>
                                <ng-template #noCtps><strong>{{ '-' }}</strong></ng-template>
                            </ng-template>
                        </ng-container>

                        
                        <ng-container *ngSwitchCase="col.field == 'internationalScoreDescription'">
                            <div class="riskRatingLabel" [ngClass]="{ 'lightGreen' : rowData.internationalScoreDescription == 'very low risk', 'cyan' : rowData.internationalScoreDescription == 'low risk', 'yellow' : rowData.internationalScoreDescription == 'moderate risk', 'orange' : rowData.internationalScoreDescription == 'high risk', 'darkRed': rowData.internationalScoreDescription == 'not scored' }">
                                {{ ( rowData.internationalScoreDescription ? rowData.internationalScoreDescription == 'not scored'? 'Not Scored / Very High Risk': rowData.internationalScoreDescription : '-' ) | titlecase }}
                            </div>
					    </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'region'">
                            {{ rowData['region'] | titlecase }}
                            <span *ngIf="!rowData['region'] || rowData['region'] == ''">{{ '-' }}</span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'pscNameFd'">
                            {{ rowData['pscNameFd'] != undefined && rowData['pscNameFd'] != null ? rowData['pscNameFd'] : '-' }}
                            <span *ngIf="!rowData['pscNameFd'] || rowData['pscNameFd'] == ''">{{ '-' }}</span>
                        </ng-container>
    
    
                        <ng-container *ngSwitchCase="col.field == 'directorName'">
                            <ng-container *ngIf="rowData['directorsData']; else noDirectorsBlock">
                                <ng-container *ngFor="let director of rowData['directorsData']; let i = index">
                                    <ng-container *ngIf="i < 4">
                                        {{ director?.detailedInformation?.fullName.trim() | titlecase }}<ng-container
                                            *ngIf="rowData['directorsData']?.length && ( i < rowData['directorsData'].length - 1 ) && i < 3">
                                            ,
                                        </ng-container>
                                        <ng-container *ngIf="rowData['directorsData']?.length && i == 3">...</ng-container>
                                    </ng-container>
                                </ng-container>
                            </ng-container>
                            <ng-template #noDirectorsBlock>-</ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'investor_name'">
                        
                            <span class="share_holdings"> {{ rowData[col.field].trim() | titlecase }} </span>
                        
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'shareHoldings'">
                            <span>
                                <ul class="badge badge-blue badge-round listStyle">
                                    <li>Total : {{rowData['shareHoldingTotalCount']}}</li>
                                </ul>
                                <ul class="badge badge-primary badge-round listStyle">
                                    <li>Live : {{rowData['shareHoldingLiveCount']}}</li>
                                </ul>
                                <ul class="badge badge-red badge-round listStyle">
                                    <li>Dissolved : {{rowData['shareHoldingDissolvedCount']}}</li>
                                </ul>
                            </span>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'shareholdingInformation'">
                            <button pButton class="ui-button-inline ui-button-sm" type="button" label="View ({{ rowData['shareHoldingTotalCount'] }})" (click)="viewShareholdingsData( rowData )" *ngIf="rowData[ 'shareHoldingTotalCount' ] > 0"></button>
                            <ng-container *ngIf="rowData[ 'shareHoldingTotalCount' ] == 0"> - </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'industryArray'">
                            <ng-container *ngIf="rowData['industryArray']?.length > 0; else noIndustryBlock">
                                <ng-container *ngFor="let industry of rowData['industryArray']; let i = index">
                                    {{ industry | titlecase }}
                                    <ng-container
                                            *ngIf="rowData['industryArray']?.length && ( i < rowData['industryArray']?.length - 1 )">
                                            ,
                                    </ng-container>
                                </ng-container>
                            </ng-container>
                            <ng-template #noIndustryBlock>-</ng-template>
                        </ng-container>

                        <ng-container *ngIf="thisPage == 'user-management' || thisPage == 'update-user'">
                            <ng-container *ngSwitchCase="col.field == 'edit'">
                                <button pButton type="button" icon="pi pi-pencil" class="mr-2 p-button-rounded p-button p-button-lg" [disabled]="rowData[col.field] > '0'" (click)="goToUserDetails( rowData )"></button>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'email'">
                            <ng-container *ngIf="[ 'showContactScreen' ].includes( thisPage ); else otherPage">
                                <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                    <img class="lockIconForFilters" src="{{ userDetails?.featureLockIconPath }}">
                                </ng-container>
                                <ng-template #otherPlans>
                                    <ng-container *ngIf = "rowData[col.field]; else noemail"> 
                                        <a class="cName" href="mailto:{{ rowData[col.field] }}">{{ rowData[col.field] }}</a>
                                    </ng-container>
                                    <ng-template #noemail> - </ng-template>
                                </ng-template>
                            </ng-container>
                            <ng-template #otherPage>
                                <ng-container *ngIf="rowData['userRole'] == 'Client Admin Master' && thisPage != 'user-management' || userAuthService.hasRolePermission( ['Client Admin'] ) || userAuthService.hasRolePermission( ['Client Admin Master'] ); else showEmailtoOthers">
                                    {{  rowData['email'] ? rowData['email'] : '-' }}
                                </ng-container>

                                <ng-template #showEmailtoOthers>
                                   <span *ngIf="rowData['userRole'] != 'Client Admin Master'">{{  rowData['email'] ? rowData['email'] : '-' }}</span>
                                </ng-template>
                            </ng-template>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'RegAddress'">
                            {{ rowData['RegAddress'] && rowData['RegAddress'] ? rowData['RegAddress'] : '-' }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'cbiladdress'">
                            {{ (rowData['cbiladdress'] != undefined && rowData['cbiladdress'] != null && rowData['cbiladdress']
                            != "" ? rowData['cbiladdress'] : "Not Provided") | titlecase}}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'personFirstName'">
                            {{ (rowData['personFirstName'] != undefined && rowData['personFirstName'] != null &&
                            rowData['personFirstName'] != "" ? rowData['personFirstName'] : "-") | titlecase }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'personLastName'">
                            {{ (rowData['personLastName'] != undefined && rowData['personLastName'] != null &&
                            rowData['personLastName'] != "" ? rowData['personLastName'] : "-") | titlecase }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'reference'">
                            {{ (rowData['reference'] != undefined && rowData['reference'] != null && rowData['reference'] != "" ? rowData['reference'] : "-") | titlecase }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'colSupplierNumbers'">
                            <ng-container *ngIf="rowData['colSupplierNumbers'] && rowData['colSupplierNumbers']?.length; else noSupplierNumber">
                                <div #descriptionTextContainer class="limitTextHeight">
                                    <ng-container *ngFor="let item of rowData['colSupplierNumbers']; let i = index">
                                        <span>{{ item }}</span>
                                        <ng-container *ngIf="rowData['colSupplierNumbers']?.length && ( i < rowData['colSupplierNumbers']?.length - 1 ) && i < 3">, <br></ng-container>
                                    </ng-container>
                                </div>
                                <a type="button" *ngIf="rowData['colSupplierNumbers']?.length > 1" href="javascript:void(0);"
                                    class="small-data-font c-green" (click)="showText(descriptionTextContainer)">Read More</a>
    
                            </ng-container>
                            <ng-template #noSupplierNumber>-</ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'personPhone'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userDetails?.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                {{ rowData['personPhone'] != undefined && rowData['personPhone'] != null && rowData['personPhone']
                                != "" ? rowData['personPhone'] : "-" }}
                            </ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'personEmail'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userDetails?.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                <ng-container *ngIf = "rowData['personEmail'] != undefined && rowData['personEmail'] != null && rowData['personEmail'] != ''; else noemail"> 
                                    <a class="cName" href="mailto:{{ rowData[col.field] }}">{{ rowData[col.field]}}</a>
                                </ng-container>
                                <ng-template #noemail> - </ng-template>
                            </ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'cWebsite'">
                            <a target="_blank" class="cName" href="http://www.{{ formatWebsite(rowData['cWebsite']) }}">{{
                                formatWebsite(rowData['cWebsite']) }}</a>
                            <span *ngIf="!rowData['cWebsite'] || rowData['cWebsite'] == ''">{{ '-' }}</span>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'companyStatus', 'company_status' ].includes(col.field)">
                            <ng-container *ngIf="rowData[ 'company_status' ] && rowData[ 'company_status' ].length; else noStatus">
                                <span [ngClass]="{ 'green': ['live', 'administration order'].includes(rowData[col.field]), 'c-orange': ['in liquidation', 'removed'].includes(rowData[col.field]), 'c-red': [ 'converted/closed', 'dissolved', 'in administration', 'in receivership / administration', 'voluntary arrangement', 'in receivership', 'deleted' ].includes(rowData[col.field]) }" class="status">
                                    {{ rowData[col.field] ? (rowData[col.field] | titlecase) : '' }}
                                </span>
                            </ng-container>
                            <ng-template #noStatus>
                                -
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'position'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userDetails?.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                {{ ( rowData['position'] ? rowData['position'] : "-" ) | titlecase }}
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'IncorporationDate'">
                            {{ rowData?.[ 'IncorporationDate' ] ? ( changeToDate( rowData["IncorporationDate"] ) | date: 'dd-MM-yyyy' ) : '-' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'companyAge'">
                            <!-- {{rowData |  json}}1111
                            {{ thisPage}} -->
                            {{ [ 'esgWatchPage', 'promptSearchAi', 'supplierResilience' ].includes( thisPage ) ? ( rowData[col.field] || '-' ) : calculateCompanyAge( rowData[ 'companyRegistrationDate' ] ) }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'investedCompany'">
                            <button pButton label="View" class="p-button-sm p-button-rounded" (click)="showDetails(rowData)"></button>
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'esgCurrentPercentage'">
                            
                            <span class="flex align-items-center justify-content-end">
                                <span class="badge badge-primary badge-round px-2 py-1" [ngClass]="{ 'badge-red': rowData['totalEsgDifference'] <= 0, 'badge-primary': rowData['totalEsgDifference'] > 0 }">
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEsgDifference'] == 0">east</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEsgDifference'] < 0">south</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEsgDifference'] > 0">north</i>
                                    <span> {{ rowData['totalEsgDifference'] ? ( ( rowData['totalEsgDifference'] < 0 ? rowData['totalEsgDifference'] * -1 : rowData['totalEsgDifference'] ) | number: '1.2-2' ) : 0 }}%</span>
                                </span>
                                <span class="ml-2">{{ rowData['esgScore'][col.field] | number: '1.2-2' }}%</span> 
                            </span>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'esgPreviousPercentage'">
                            {{ rowData['esgScore'][col.field] | number: '1.2-2' }}%
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'msmeCategory'">
                            <span class="riskRatingLabel inline-block" [ngStyle]="{'background-color': msmeStatusColor[ rowData[col.field] ], 'color': '#fff' }">{{ rowData[col.field] | titlecase }}</span>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'ethnic_share_percentage', 'female_owned_share_percentage' ].includes( col.field )">
                            {{ rowData[col.field] ? ( rowData[col.field] | number: '1.2-2' ) : '-' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'suppliers'">

                            <ng-container *ngIf="rowData['suppliers'] && rowData['suppliers']?.length; else noSupplierName">

                                <div #descriptionTextContainer class="limitTextHeight">
                                    <ng-container *ngFor="let item of rowData['suppliers']; let i = index">
										<ng-container *ngIf="i < 4">
											<ng-container *ngIf="item['name'] && item['customSupplierReg']">
                                                <span>
                                                        {{ item['name'] | uppercase }}
                                                </span>
                                            </ng-container>
            
                                            <ng-container *ngIf="item['name'] && item['supplierReg']">
                                                <span>
                                                    {{ item['name'] | uppercase }}
                                                </span>
                                            </ng-container>
                                            <ng-container *ngIf="rowData['suppliers']?.length && ( i < rowData['suppliers']?.length - 1 ) && i < 3">, <br></ng-container>
										</ng-container>
									</ng-container>
                                </div>
                                <a type="button" *ngIf="rowData['suppliers']?.length > 2 || rowData['suppliers'][0]['name']?.length > 30" href="javascript:void(0);"
                                    class="small-data-font c-green" (click)="showText(descriptionTextContainer)">Read More</a>

                            </ng-container>
                            <ng-template #noSupplierName>-</ng-template>

                        </ng-container>

                        <ng-container *ngIf="thisPage == 'suppliersDashboard'">
                            <ng-container *ngSwitchCase="col.field == 'buyer_name'">
                                <button pButton class="ui-button-inline ui-button-sm" type="button" label="View"></button>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'suitablefor'">
                            <div>
                                <strong>SME :</strong> {{ rowData['isSuitableforSME'] == true ? 'Yes' : 'No'}}
                            </div>
                            <div>
                                <strong>VCO :</strong> {{ rowData['isSuitableforVCO']  == true ? 'Yes' : 'No' }}
                            </div>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'eCurrentPercentage'">
                          
                            <span class="flex align-items-center justify-content-end">
                                <span class="badge badge-primary badge-round px-2 py-1" [ngClass]="{ 'badge-red': rowData['totalEdifference'] <= 0, 'badge-primary': rowData['totalEdifference'] > 0 }">
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEdifference'] == 0">east</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEdifference'] < 0">south</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalEdifference'] > 0">north</i>
                                    <span> {{ rowData['totalEdifference'] ? ( ( rowData['totalEdifference'] < 0 ? rowData['totalEdifference'] * -1 : rowData['totalEdifference'] ) | number: '1.2-2' ) : 0 }}%</span>
                                </span>
                                <span class="ml-2"> {{ rowData['eScore'][col.field] | number: '1.2-2' }}%</span> 
                            </span>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'ePreviousPercentage'">
                            {{ rowData['eScore'][col.field] | number: '1.2-2' }}%
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'sCurrentPercentage'">
                    
                            <span class="flex align-items-center justify-content-end">
                                <span class="badge badge-primary badge-round px-2 py-1" [ngClass]="{ 'badge-red': rowData['totalSdifference'] <= 0, 'badge-primary': rowData['totalSdifference'] > 0 }">
                                    <i class="material-icons fs-small" *ngIf="rowData['totalSdifference'] == 0">east</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalSdifference'] < 0">south</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalSdifference'] > 0">north</i>
                                    <span> {{ rowData['totalSdifference'] ? ( ( rowData['totalSdifference'] < 0 ? rowData['totalSdifference'] * -1 : rowData['totalSdifference'] ) | number: '1.2-2' ) : 0 }}%</span>
                                </span>
                                <span class="ml-2"> {{ rowData['sScore'][col.field] | number: '1.2-2' }}%</span> 
                            </span>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'sPreviousPercentage'">
                            {{ rowData['sScore'][col.field] | number: '1.2-2' }}%
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'gCurrentPercentage'">

                            <span class="flex align-items-center justify-content-end">
                                <span class="badge badge-primary badge-round px-2 py-1" [ngClass]="{ 'badge-red': rowData['totalGdifference'] <= 0, 'badge-primary': rowData['totalGdifference'] > 0 }">
                                    <i class="material-icons fs-small" *ngIf="rowData['totalGdifference'] == 0">east</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalGdifference'] < 0">south</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalGdifference'] > 0">north</i>
                                    <span> {{ rowData['totalGdifference'] ? ( ( rowData['totalGdifference'] < 0 ? rowData['totalGdifference'] * -1 : rowData['totalGdifference'] ) | number: '1.2-2' ) : 0 }}%</span>
                                </span>
                                <span class="ml-2">  {{ rowData['gScore'][col.field] | number: '1.2-2' }}%</span> 
                            </span>
                            
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'gPreviousPercentage'">
                            {{ rowData['gScore'][col.field] | number: '1.2-2' }}%
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'carbonCurrentTotal'">
                       
                            <span class="flex align-items-center justify-content-end">
                                <span class="badge badge-primary badge-round px-2 py-1" [ngClass]="{ 'badge-primary': rowData['totalCarbondifference'] <= 0, 'badge-red': rowData['totalCarbondifference'] > 0 }">
                                    <i class="material-icons fs-small" *ngIf="rowData['totalCarbondifference'] == 0">east</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalCarbondifference'] < 0">south</i>
                                    <i class="material-icons fs-small" *ngIf="rowData['totalCarbondifference'] > 0">north</i>
                                    <span> {{ rowData['totalCarbondifference'] ? ( ( rowData['totalCarbondifference'] < 0 ? rowData['totalCarbondifference'] * -1 : rowData['totalCarbondifference'] ) | number: '1.0-2' ) : 0 }}%</span>
                                </span>
                                <span class="ml-2 fs-medium">{{ rowData['carbonEmission'][col.field] | number: '1.0-2' }}</span> 
                            </span>
                            <div><small class="c-light"><small>Tonnes of CO<sub>2</sub>e</small></small></div>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'carbonPreviousTotal'">
                            <span class="fs-medium">{{ rowData['carbonEmission'][col.field] | number: '1.0-2' }}</span>
                            <div><small class="c-light"><small>Tonnes of CO<sub>2</sub>e</small></small></div>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'companyRegistrationDate'">
                            {{ rowData[col.field] ? ( changeToDate( rowData[col.field] ) | date: 'dd-MM-yyyy' ) : '-' }}
                        </ng-container>
                        <ng-container *ngSwitchCase="[ 'turnover', 'estimated_turnover' ].includes( col.field )">
                            <ng-container *ngIf=" thisPage == 'webWidgetPage'">
                                <ng-container *ngIf=" ((rowData?.turnover && rowData?.turnover !== '-') || (rowData?.estimated_turnover && rowData?.estimated_turnover !== '-') ); else noDataBlock">
                                    <ng-container *ngIf="rowData?.turnover || rowData?.estimated_turnover">
                                        <ng-container *ngIf="rowData.turnover < 0" >
                                            <span class="c-red"> 
                                                ( {{ ( rowData.turnover * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} ) 
                                            </span>
                                        </ng-container>
                                        <ng-container *ngIf="rowData.estimated_turnover < 0">
                                                <span class="c-red">
                                                    * ( {{  ( rowData.estimated_turnover * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} )
                                                </span>
                                        </ng-container>
    
                                        <ng-container *ngIf="rowData.turnover > 0">
                                            <span class="c-green"> 
                                                    {{ rowData.turnover | currency: selectedGlobalCurrency : 'symbol' : '1.0-0'}} <br>
                                            </span>
                                        </ng-container>
                                        <ng-container *ngIf="rowData.estimated_turnover > 0">
                                                <span class="c-blue"> 
                                                    * {{ rowData.estimated_turnover | currency: selectedGlobalCurrency : 'symbol' : '1.0-0'}} <br>
                                                </span>
                                        </ng-container>
                                    </ng-container>
                                </ng-container>
                                <ng-template #noDataBlock>
                                    -
                                </ng-template>
                            </ng-container>
                            <ng-container *ngIf=" thisPage !== 'webWidgetPage'">
                                <ng-container *ngSwitchCase="col.field == 'turnover'">
                                    <ng-container *ngIf="thisPage !== 'showChargesTablePage'; else forChargesPage">
                                        {{ (rowData['turnover'] != null && rowData['turnover'] != undefined ? rowData['turnover'] : 0 )
                                        |
                                        currency:selectedGlobalCurrency:'symbol':'1.0-0' }}
                                    </ng-container>
            
                                    <ng-template #forChargesPage>
            
                                        <ng-container *ngIf="rowData[col.field];else noDataBlock">
                                            <ng-container *ngIf="rowData[col.field] < 0; else positiveValue">
                                                <span class="c-red">
                                                    ( {{ ( rowData[col.field] * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} )
                                                </span>
                                            </ng-container>
                                            <ng-template #positiveValue>
                                                <span class="c-green">
                                                    {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }}
                                                </span>
                                            </ng-template>
                                        </ng-container>
                                        <ng-template #noDataBlock>
                                            -
                                        </ng-template>
                                    </ng-template>
            
                                </ng-container>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'created_at','last_visit_by_organisation','StartTime'].includes(col.field)">
                            {{ (rowData[col.field] ? datePipe.transform(rowData[col.field], 'yyyy-MM-dd HH:mm:ss', 'IST') : '-') | titlecase }}
                        
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'totalShareholdersEquity'">
                            {{ (rowData['totalShareholdersEquity'] != null && rowData['totalShareholdersEquity'] != undefined ?
                            rowData['totalShareholdersEquity'] : 0 ) | currency:selectedGlobalCurrency:'symbol':'1.0-0' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'transactionNumber'">
                            {{ rowData[col.field] ? ( rowData[col.field] | number: '1.0-0' ) : '-' }}
                        </ng-container>
                    
                        <ng-container *ngSwitchCase="col.field == 'total'">
                            {{ rowData[col.field] ? ( rowData[col.field] | currency: selectedGlobalCurrency: 'symbol': '1.2-2' ) : '-' }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'netWorth'">
    
                            <ng-container *ngIf="thisPage != 'showChargesTablePage'; else forChargesPage">
                                {{ ( rowData['netWorth'] != null && rowData['netWorth'] != undefined  && rowData['netWorth'] != '-' ? rowData['netWorth'] : 0 )
                                |
                                currency:selectedGlobalCurrency:'symbol':'1.0-0' }}
                            </ng-container>
    
                            <ng-template #forChargesPage>
    
                                <ng-container *ngIf="rowData[col.field];else noDataBlock">
                                    <ng-container *ngIf="rowData[col.field] < 0; else positiveValue">
                                        <span class="c-red">
                                            ( {{ ( rowData[col.field] * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} )
                                        </span>
                                    </ng-container>
                                    <ng-template #positiveValue>
                                        <span class="c-green">
                                            {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }}
                                        </span>
                                    </ng-template>
                                </ng-container>
    
                                <ng-template #noDataBlock>
                                    -
                                </ng-template>
                            </ng-template>
    
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'noticeIdentifier', 'notice_identifier' ].includes( col.field )">
							<ng-container *ngIf="rowData[col.field]; else elseBlock">
								<a href="javascript: void(0);" class="cName" (click)="showNoticeIndentifier( rowData[col.field] )"> {{ rowData[col.field] | uppercase }}</a>
							</ng-container>
							<ng-template #elseBlock> {{ ( rowData[col.field] ? rowData[col.field] : '-' ) | uppercase }} </ng-template>
						</ng-container>

                        <ng-container *ngSwitchCase="[ 'PRETAX_PROFIT_PERCENTAGE', 'CURRENT_RATIO', 'SALES_PER_NET_WORKING_CAPITAL', 'GEARING_RATIO', 'EQUITY_RATIO', 'CREDITOR_DAYS', 'DEBTOR_DAYS', 'LIQUIDITY_TEST', 'RETURN_CAPITAL_EMPLOYED', 'RETURN_TOTAL_ASSETS', 'DEBT_EQUITY', 'RETURN_EQUITY', 'RETURN_NET_ASSETS', 'TOTAL_DEBT_RATIO' ].includes( col.field )">
                            <span [ngClass]="{'c-red': rowData[col.field] < 0, 'c-green':  rowData[col.field] > 0}">
                                {{ rowData[col.field] }}
                            </span>
						</ng-container>

                        <ng-container *ngSwitchCase="col.field == 'title'">
                            <ng-container *ngIf="rowData['procurementReference'] || rowData['notice_identifier']; else elseBlockss">
								<a href="javascript: void(0);" class="cName" (click)="showNoticeIndentifier( rowData['procurementReference'] ? rowData['procurementReference'] :  rowData['notice_identifier'] )"> {{ rowData[col.field] | titlecase }}</a>
							</ng-container>
							<ng-template #elseBlockss> {{ ( rowData[col.field] ? rowData[col.field] : '-' ) | uppercase }} </ng-template>
						</ng-container>

                        <ng-container *ngSwitchCase="col.field == 'closing_date'">                            
                            <div>
                                {{rowData[col.field]}}
                            </div>                            
                            <ng-container *ngIf=" rowData['noOfDaysLeft'] >=0 && rowData['noOfDaysLeft'] != null && rowData['noOfDaysLeft'] != undefined && rowData['noOfDaysLeft'] != '' " >
                                <div class="mt-1">
                                    <span [ngClass]="{'c-red': rowData['noOfDaysLeft'] > 0 && rowData['noOfDaysLeft'] <= 10, 'amberYellow':  rowData['noOfDaysLeft'] > 10 && rowData['noOfDaysLeft'] < 16, 'c-green':  rowData['noOfDaysLeft'] >= 16}">
                                        <strong>
                                            {{ rowData['noOfDaysLeft'] }}
                                        </strong>
                                        <ng-container *ngIf="rowData['noOfDaysLeft'] == 1; else otherBlock">
                                            Day Left
                                        </ng-container>
                                        <ng-template #otherBlock>
                                            Days Left
                                        </ng-template>
                                    </span>
                                </div>
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'contract_end_date'">
                            {{ rowData[col.field] ? rowData[col.field] : '-' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'cpv_codes', 'cpvCodes', 'cpvCode' ].includes( col.field )">
                            <ng-container *ngIf="rowData[col.field]?.length > 0; else noCpvCode">
                                <div [dgReadMore]="true" [numberOfLines]="1">
                                    <ng-container class="p-my-1" *ngFor="let item of rowData[col.field]">
                                       <div>{{ item.code }} - {{ item.desc | titlecase }}</div>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <ng-template #noCpvCode>-</ng-template>
						</ng-container>

                        <ng-container *ngSwitchCase="[ 'code_desc_key' ].includes( col.field )">
                            <ng-container *ngIf="rowData[col.field]?.length > 0; else noCpvCode">
                                <div  #descriptionTextContainer class="limitTextHeight">
                                    <ng-container *ngFor="let item of rowData?.code_desc_key">
                                        <div class="key-value" >{{ item.code }} {{ (item.desc ? ' - ' + item.desc : '') | titlecase }}</div>
                                    </ng-container>
                                </div>
                                <a type="button" *ngIf="rowData['code_desc_key']?.length > 1" href="javascript:void(0);"
                                    class="small-data-font c-green" (click)="showText(descriptionTextContainer)">Read More</a>
                            </ng-container>
                            <ng-template #noCpvCode>-</ng-template>
						</ng-container>

                        <ng-container *ngSwitchCase="[ 'cpv_codes_tree' ].includes( col.field )">
                            <ng-container *ngIf="rowData[col.field]?.length > 0; else noCpvCode">
                                <div [dgReadMore]="true" [numberOfLines]="1">
                                    <div class="p-my-1" *ngFor="let item of rowData[col.field]">
                                        {{ item.code_desc_key | titlecase }}
                                    </div>
                                </div>
                            </ng-container>
                            <ng-template #noCpvCode>-</ng-template>
						</ng-container>

                        <ng-container *ngSwitchCase="[ 'total_contract_presented', 'suppliers_count', 'totalContractsWon', 'share_holders_count', 'active_director_count' ].includes( col.field )">
                            <ng-container *ngIf="rowData[col.field]; else showHyphen">
                                {{ rowData[col.field] | number: '1.0-0' }}
                            </ng-container>
                            <ng-template #showHyphen>
                                -
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'lastmade'">
                            {{ rowData['accountsMadeUpDate'] !== undefined && rowData['accountsMadeUpDate'] !== null &&
                            rowData['accountsMadeUpDate'] !== '' ? (changeToDate(rowData["accountsMadeUpDate"]) | date:
                            'dd-MM-yyyy') : '-' }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'lastChange'">
                            <ng-container *ngIf="rowData['changes'] && rowData['changes'][0]; else noDataBlock">
                                {{ (rowData['changes'][0]['description'] ? rowData['changes'][0]['description'] : '-') | titlecase }}
                            </ng-container>
                            <ng-template #noDataBlock>
                                -
                            </ng-template>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'registrationDate', 'filedDate' ].includes(col.field)">

                            <ng-container *ngIf="col.field == 'registrationDate'">
                                <ng-container *ngIf="rowData['changes'] && rowData['changes'][0]['statusRegistrationDate']; else noDataBlock">
                                    {{ rowData['changes'][0]['statusRegistrationDate'] | date: 'dd-MM-yyyy'  }}
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="col.field == 'filedDate'">
                                <ng-container *ngIf="rowData['changes'] && rowData['changes'][0]['statusFiledDate']; else noDataBlock">
                                    {{ rowData['changes'][0]['statusFiledDate'] | date: 'dd-MM-yyyy'  }}
                                </ng-container>
                            </ng-container>

                            <ng-template #noDataBlock>
                                -
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'changeToClient'">
                            <div class="p-col-12" *ngIf="rowData['userRole'] !== 'Client Admin Master'">
                                <div class="p-grid">
                                    <label class="mr-2">Client Admin</label>
                                    <p-inputSwitch name="clientAdmin" [(ngModel)]="rowData['isClientAdminCheck']" (onChange)="changeToClientAdmin( rowData )" [disabled]="rowData['userRole'] == 'Client Admin Master' && (isClientAdminLength && isClientAdminLength == 1)"></p-inputSwitch>
                                </div>
                            </div>

                        </ng-container>
    
    
                        <ng-container *ngSwitchCase="col.field == 'noOfCcj'">
                            {{ (rowData['noOfCcj'] != null && rowData['noOfCcj'] != undefined ? rowData['noOfCcj'] : 0 ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'noOfCharges'">
                            {{ (rowData['noOfCharges'] != null && rowData['noOfCharges'] != undefined ? rowData['noOfCharges'] :
                            0 ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase=" [ 'companyType', 'Organisation' ].includes(col.field)">
                            {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'noOfLandCorp'">
                            {{ (rowData['noOfLandCorp'] != null && rowData['noOfLandCorp'] != undefined ?
                            rowData['noOfLandCorp'] : 0 ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'noOfShareHolders'">
                            {{ (rowData['noOfShareHolders'] != null && rowData['noOfShareHolders'] != undefined ?
                            rowData['noOfShareHolders'] : 0 ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'totalDirectorsCount'">
                            {{ (rowData['totalDirectorsCount'] != null && rowData['totalDirectorsCount'] != undefined ?
                            rowData['totalDirectorsCount'] : 0 ) }}
                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'username', 'occupation' ].includes( col.field )">

                            <ng-container *ngIf="userAuthService.hasRolePermission( ['Super Admin'] ) && thisPage == 'user-management' && col.field == 'username'">
                                <i class="material-icons valign-m c-voilet mr-1">{{ ( rowData['userRole'] == 'Client Admin Master' ) ? 'people' : 'person' }}</i>
                            </ng-container>

                            <ng-container *ngIf="userAuthService.hasRolePermission( ['Super Admin'] ) && rowData['userRole'] == 'Client Admin Master' && thisPage == 'user-management'; else forIndividualUsers">
                               {{ rowData['companyName'] | titlecase }}
                            </ng-container>

                            <ng-template #forIndividualUsers>
                                {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                            </ng-template>                           
                            <span *ngIf="userAuthService.hasRolePermission( ['Super Admin'] ) && thisPage == 'user-management' && col.field == 'username'"><i class="pi pi-clock ml-2 cName" (click)="showUserinfoDialogBox(rowData._id)"></i></span>

                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'job_title' ].includes( col.field )">

                            {{ rowData[col.field] ? rowData[col.field] : '-' }}

                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'subs_startDate', 'subs_endDate' ].includes( col.field )">

                             <ng-container *ngIf="rowData['userRole'] == 'Client Admin Master' && thisPage != 'user-management'; else showPhonetoOthers">
                                {{ rowData[col.field] ? ( rowData[col.field] | date: 'dd-MM-yyyy HH:mm:ss' ) : '-' }}
                            </ng-container>

                            <ng-template #showPhonetoOthers>
                               {{ rowData[col.field] ? ( rowData[col.field] | date: 'dd-MM-yyyy HH:mm:ss' ) : '-' }}
                            </ng-template>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'phoneNumber'">
                            
                            <ng-container *ngIf="rowData['userRole'] == 'Client Admin Master' && thisPage != 'user-management'; else showPhonetoOthers">
                                {{  rowData['phoneNumber'] ? rowData['phoneNumber'] : '-' }}
                            </ng-container>

                            <ng-template #showPhonetoOthers>
                               <span *ngIf="rowData['userRole'] != 'Client Admin Master'">{{  rowData['phoneNumber'] ? rowData['phoneNumber'] : '-' }}</span>
                            </ng-template>

                        </ng-container>

                        <ng-container *ngSwitchCase="['logInTime' ].includes( col.field )">
                            <ng-container *ngIf="rowData['userRole'] == 'Client Admin Master' && thisPage != 'user-management'; else showPhonetoOthers">
                                {{ rowData[col.field] ? ( rowData[col.field] ) : '-' }}
                            </ng-container>

                            <ng-template #showPhonetoOthers>
                                <ng-container *ngIf="rowData['userRole'] != 'Client Admin Master'">
                                    <span [ngClass]="{ 'amberYellow': rowData['daysOnLogin'] >=7 && rowData['daysOnLogin'] <13, 'c-red': rowData['daysOnLogin'] >=14 }">
                                        <!-- {{ rowData[col.field] ? ( rowData[col.field] ) : '-' }} -->
                                        {{ rowData[col.field] ? ( rowData[col.field] ) : '-' }}
                                    </span>
                                </ng-container>
                            </ng-template>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'notice_type'">
                            {{ (rowData[col.field] && rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                        </ng-container>

                        <ng-container *ngIf="['buyersDashboard', 'suppliersDashboard', 'contractFinderPage' ].includes(thisPage)">

                            <ng-container *ngSwitchCase="[ 'postcode', 'ward', 'constituency', 'county', 'country' ].includes(col.field)">

                                <ng-container *ngIf="col.field !== 'postcode'">
                                    <ng-container *ngIf="rowData[col.field]?.length > 0; else noRegionArray">
                                        <div [dgReadMore]="true" [numberOfLines]="1">
                                            {{ formattedCamelCaseToSentence(rowData[col.field].toString()) | uppercase }}
                                        </div>
                                    </ng-container>
                                </ng-container>

                                <ng-container *ngIf="col.field == 'postcode'">
                                    <ng-container *ngIf="rowData[col.field]?.length > 0; else noRegionArray">
                                        <div [dgReadMore]="true" [numberOfLines]="1">
                                            {{ formattedCamelCaseToSentence(rowData[col.field].toString()) | uppercase }}
                                        </div>
                                    </ng-container>
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="col.field == 'viewButton'">
                                <button pButton class="ui-button-inline ui-button-sm" type="button" label="View" (click)="viewShareholdingsData( rowData )"></button>
                            </ng-container>

                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'awardedDate'">
                            {{  rowData['awardedDate'] != '' ? rowData['awardedDate'] : '-' }}
                        </ng-container>

                        <ng-container *ngSwitchCase="[ 'awardedValue','awarded_value', 'total_contracts_published_value', 'lowValueOfContract', 'highValueOfContract' ].includes( col.field )">
                            <ng-container *ngIf="(rowData[col.field] && rowData[col.field] !== ''); else otherBlock">
                                {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }}
                            </ng-container>
                            <ng-template #otherBlock>
                                -
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="(col.field == 'buyerName') && ( thisPage !== 'contractFinderPage' )">
                            <ng-container *ngIf="rowData['buyerName'] && rowData['companyNumber']; else elseBlock">
                                <a class="cName " target="_blank" href="javascript:void(0)" [routerLink]="'/company/' + rowData['companyNumber'] + '/' + formatCompanyNameForUrl(rowData['buyerName'] | titlecase)">{{ rowData[col.field] | titlecase }}</a>
                            </ng-container>
                            <ng-template #elseBlock>
                                {{ ( rowData[col.field] ? rowData[col.field] : '-' ) | titlecase }}
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'totalAwardValue'">
                            <ng-container *ngIf="(rowData[col.field] && rowData[col.field] !== ''); else otherBlock">
                                {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }}
                            </ng-container>
                            <ng-template #otherBlock>
                                -
                            </ng-template>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'referredData'">
                            {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}    
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'subs_duration'">
                            <ng-container *ngIf="rowData[col.field] && rowData[col.field] > 1">
                                {{ (rowData[col.field] ? rowData[col.field] : '-') }} Days
                            </ng-container> 
                            <ng-container *ngIf="rowData[col.field] && rowData[col.field] == 1">
                                {{ (rowData[col.field] ? rowData[col.field] : '-') }} Day
                            </ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'credibility'">
							<ng-container *ngIf="rowData['credibility'] && rowData['credibility'] == 'low' ; else otherBlock">
                        
                                <strong>{{ rowData[col.field] | titlecase }}</strong>
                                
                            </ng-container>
                            
                            <ng-template #otherBlock>

                               <strong>High</strong>

                            </ng-template>
						</ng-container>
                        
                        <ng-container *ngSwitchCase="[ 'isEmailVerified', 'emailSubscription', 'payment_mode_offline' ].includes( col.field )">
                            <ng-container *ngIf="rowData[col.field]"><i class="pi pi-check c-green"></i></ng-container>
                            <ng-container *ngIf="!rowData[col.field]"><i class="pi pi-times c-red"></i></ng-container>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'fullySatisfiedCount' ">
                            <span
                                [ngClass]="{ 'c-green' : rowData['fullySatisfiedCount'] && rowData['fullySatisfiedCount'] > 0  }">
                                <strong>{{ rowData[col.field] }}</strong>
                            </span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'outstandingCount' ">
                            <span [ngClass]="{ 'c-red' : rowData['outstandingCount'] && rowData['outstandingCount'] > 0  }">
                                <strong>{{ rowData[col.field] }}</strong>
                            </span>
                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'turnover_latest', 'estimated_turnover', 'totalAssets_latest', 'totalLiabilities_latest', 'netWorth_latest', 'grossProfit_latest' ].includes( col.field )">
    
                            <ng-container *ngIf="rowData[col.field] && rowData[col.field] !== '-' ; else noDataBlock">
                                <ng-container *ngIf="rowData[col.field] < 0; else positiveValue">
                                    <span class="c-red">
                                        ( {{ ( rowData[col.field] * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} ) 
                                    </span>
                                </ng-container>
                                <ng-template #positiveValue>
                                    <span class="c-green"> {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} </span>
                                </ng-template>
                            </ng-container>
                            <ng-template #noDataBlock>
                                -
                            </ng-template>
    
                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'total_shareholding', 'shareHoldingsCountLive', 'numShareHolder' ].includes( col.field )">

                            <button pButton class="ui-button-inline ui-button-sm" type="button" label="View ({{ rowData[col.field] }})" (click)="viewShareholdingsData( rowData )" *ngIf="rowData[col.field]"></button>

                            <ng-container *ngIf="!rowData[ col.field ] && rowData[ col.field ] !== 0"> - </ng-container>

                        </ng-container>
    
                        <ng-container *ngSwitchCase="[ 'full_name', 'director_name' ].includes( col.field )">
    
                            <span class="companyLogoAlign" *ngIf="rowData?.imageUrl; else noDirectorImage">
                                <img class="companyLogoSize" *ngIf="rowData?.imageUrl" src="{{ rowData?.imageUrl }}" alt="Director Image" />
                            </span>
                            <ng-template #noDirectorImage>
                                <span>
                                    <img class="companyLogoSize" src="https://img.icons8.com/ultraviolet/40/000000/person-male.png" alt="Default Image" />
                                </span>
                            </ng-template>

                            <ng-container *ngIf="thisPage == 'showDirectorScreenPage'; else otherPage">
                                <a class="cName" [href]="'/director/' + ( ( rowData['directorTitle'] ? rowData['directorTitle'] : '' ) + ' ' + rowData[col.field]?.trim() | titlecase ) + '/' +  rowData['pnr']" target="_blank"> {{ ( rowData['directorTitle'] ? rowData['directorTitle'] : '' ) + ' ' + rowData[col.field] | titlecase }}</a>
                            </ng-container>

                            <ng-template #otherPage>
                                <a class="cName" [href]="'/director/' + (rowData[col.field]?.trim() | titlecase) + '/' +  rowData['pnr']" target="_blank"> {{ rowData[col.field] | titlecase }}</a>
                            </ng-template>
    
                        </ng-container>
    
                        <ng-container *ngSwitchCase="col.field == 'appointed_date'">
                            {{ rowData[col.field] !== undefined && rowData[col.field] !== null && rowData[col.field] !== '' ?
                            (changeToDate(rowData[col.field]) | date: 'dd-MM-yyyy') : '-' }}
                        </ng-container>
                        
                        <ng-container *ngSwitchCase="col.field == 'email_id'">
                            <ng-container *ngIf="subscribedPlanModal['Valentine_Special'].includes( userDetails?.planId ); else otherPlans">
                                <img class="lockIconForFilters" src="{{ userDetails?.featureLockIconPath }}">
                            </ng-container>
                            <ng-template #otherPlans>
                                <span *ngIf="rowData[col.field] && rowData[col.field] != ''"><strong>
                                        <a class="cName" href="mailto:{{ rowData[col.field] }}">{{ rowData[col.field]
                                            }}</a></strong></span>
                                <span *ngIf="!rowData[col.field] || rowData[col.field] == ''"><strong>{{'-'}}</strong></span>
                            </ng-template>
                            
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'age_director_diversity'">

                            <ng-container *ngIf="checkAllRowDataCount( rowData[col.field] ); else noData">

                                <div class="barParent">
    
                                    <span *ngIf="rowData[ col.field ]['belowTo30'] !== 0" class="bar belowTo30" [ngStyle]="{ 'width': calculateBarWidth( rowData[ col.field ], rowData[ col.field ][ 'belowTo30' ] ) }"> <span class="countCircle">{{ rowData[ col.field ]['belowTo30'] | number }}</span> </span>
    
                                    <span *ngIf="rowData[ col.field ]['30To50'] !== 0" class="bar thirtyToFifty" [ngStyle]="{ 'width': calculateBarWidth( rowData[ col.field ], rowData[ col.field ][ '30To50' ] ) }"> <span class="countCircle">{{ rowData[ col.field ]['30To50'] | number }}</span> </span>
    
                                    <span *ngIf="rowData[ col.field ]['50To65'] !== 0" class="bar fiftyToSixtyfive" [ngStyle]="{ 'width': calculateBarWidth( rowData[ col.field ], rowData[ col.field ][ '50To65' ] ) }"> <span class="countCircle">{{ rowData[ col.field ]['50To65'] | number }}</span> </span>
    
                                    <span *ngIf="rowData[ col.field ]['aboveTo65'] !== 0" class="bar above65" [ngStyle]="{ 'width': calculateBarWidth( rowData[ col.field ], rowData[ col.field ][ 'aboveTo65' ] ) }"> <span class="countCircle">{{ rowData[ col.field ]['aboveTo65'] | number }}</span> </span>
                                </div>

                            </ng-container>

                            <ng-template #noData>-</ng-template>

                        </ng-container>
                        
                        <ng-container *ngIf="thisPage == 'showDirectorScreenPage'">
                            <ng-container *ngSwitchCase="col.field == 'status'">
                                <ng-container *ngIf="rowData['status'] == 'active'">
                                    <i class="ui-icon-lens green"></i>
                                </ng-container>
        
                                <ng-container *ngIf="rowData['status'] == 'resigned'">
                                    <i class="ui-icon-lens red"></i>
                                </ng-container>
        
                                <ng-container *ngIf="rowData['status'] == 'inactive'">
                                    <i class="ui-icon-lens c-light"></i>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                        <ng-container *ngSwitchDefault>
                            <ng-container *ngIf="toCheckStringType( rowData[col.field] ) && thisPage == 'buyersDashboard'; else forOtherPages">
                                {{ (rowData[col.field] ? rowData[col.field] : '-') | titlecase }}
                            </ng-container>
                            <ng-template #forOtherPages>
                                <ng-container *ngIf="thisPage == 'showTradeTablePage'; else otherBlock">

                                    <ng-container *ngIf="[ 'exportAmount', 'exchangeRateEffect' ].includes( col.field )">
    
                                        <ng-container *ngIf="rowData[col.field] != null; else noDataBlock">
                                            <ng-container *ngIf="rowData[col.field] < 0; else positiveValue">
                                                <span class="c-red">
                                                   ( {{ ( rowData[col.field] * -1 ) | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }} )
                                                </span>
                                            </ng-container>
                                            <ng-template #positiveValue>
                                                <span class="c-green"> {{ rowData[col.field] | currency: selectedGlobalCurrency : 'symbol' : '1.0-0' }}</span>
                                            </ng-template>
                                        </ng-container>
                
                                    </ng-container>
                                    <ng-container *ngIf="[ 'lastOneYearExports', 'lastFiveYearExports', 'lastOneYearImports', 'lastFiveYearImports' ].includes( col.field )">
                                        <ng-container *ngIf="(rowData[col.field] >= 0 && rowData[col.field] != null); else noDataBlock">
                                            {{ rowData[col.field] }}
                                        </ng-container>
                                    </ng-container>
                                    <ng-template #noDataBlock>
                                        <span>-</span>
                                    </ng-template>
                                    <ng-container *ngIf="![ 'exportAmount', 'lastOneYearExports', 'lastFiveYearExports', 'lastOneYearImports', 'lastFiveYearImports','exchangeRateEffect' ].includes( col.field )">

                                        {{ rowData[col.field] === 0  ? rowData[col.field] : rowData[col.field] ? rowData[col.field] : '-' }}
                                    </ng-container>

                                </ng-container>
                                <ng-template #otherBlock>
                                    {{ rowData[col.field] ? rowData[col.field] : '-' }}
                                </ng-template>
                            </ng-template>
                        </ng-container>
                        
                    </td>

                </tr>

            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="columns?.length">No records found.</td>
                </tr>
            </ng-template>

        </p-table>

    </div>

</ng-template>

<div #chargesDataPopupOnHover class="card chargesDataPopup" *ngIf="chargeOnHoverData">

    <div class="p-grid mb-2" class="popoverListItem" *ngIf="chargeDescription">
        <div class="col-5 md:col-5">
            <strong>Charge Description:</strong>
        </div>
        <div class="col-7 md:col-7">
            {{ chargeDescription }}
        </div>
        <!--  Hsbc Uk Bank Plc As Security Trustee -->
    </div>

    <div class="p-grid mb-2" class="popoverListItem" *ngIf="chargeMonth">
        <div class="col-5 md:col-5">
            <strong>Charge Date:</strong>
        </div>
        <div class="col-7 md:col-7">
            {{ chargeMonth }}
        </div>
    </div>

    <div class="p-grid mb-2" class="popoverListItem" *ngIf="tagNameData">
        <div class="col-5 md:col-5">
            <strong>Charge Tag:</strong>
        </div>
        <div class="col-7 md:col-7">
            <ng-container *ngIf="tagNameData?.length >= 200; else default">
                <span>{{ tagNameData.substring(0, 50)+"..." }}</span>
            </ng-container>
            <ng-template #default>
                {{ tagNameData }}
            </ng-template>
        </div>
    </div>

    <div class="p-grid mb-2" class="popoverListItem" *ngIf="shortParticular">
        <div class="col-5 md:col-5">
            <strong>Short Particular:</strong>
        </div>
        <div class="col-7 md:col-7">
            <ng-container *ngIf="shortParticular?.length >= 380; else default">
                {{ shortParticular.substring(0, 280)+"..." }}
            </ng-container>
            <ng-template #default>
                {{ shortParticular }}
            </ng-template>
        </div>
    </div>

</div>

<!-- Company Quick Info Block Bussiness Watch -->
<div #companyQuickInfoPopover class="card companyDetailPopup" *ngIf="quickInfoData">
    <ng-container *ngIf="thisPage == 'contractFinderPage'; else other">
        <div class="mb-2">
            <h4 class="mt-0 mb-1">
                <strong>{{ quickInfoData['name'] | uppercase }}</strong>
            </h4>
            <div>{{ quickInfoData['address'] | titlecase }}</div>
        </div>
        <hr>
        <div *ngIf="quickInfoData['companyStatus']" class="mb-3">
            <span [ngClass]="{ 'green': [ 'live', 'administration order' ].includes( quickInfoData['companyStatus'] ), 'c-orange': [ 'in liquidation', 'removed' ].includes( quickInfoData['companyStatus'] ), 'c-red': [ 'converted/closed', 'dissolved', 'in administration', 'in receivership / administration', 'voluntary arrangement', 'in receivership', 'deleted' ].includes( quickInfoData['companyStatus'] ) }" class="status">{{ quickInfoData['companyStatus'] | uppercase }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['supplierReg']">
            <i class="ui-icon-label-outline mr-2"></i>
            <span>Company No.: {{ quickInfoData['supplierReg'] | uppercase }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['customSupplierReg']">
            <i class="ui-icon-label-outline mr-2"></i>
            <span>Company No.: {{ quickInfoData['customSupplierReg'] | uppercase }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['companyType']">
            <i class="ui-icon-folder-open mr-2"></i>
            <span>{{ quickInfoData['companyType'] | titlecase }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['companyRegistrationDate']">
            <i class="ui-icon-perm-contact-calendar mr-2"></i>
            <span>{{ changeToDate( quickInfoData['companyRegistrationDate'] ) | date : "dd-MM-yyyy" }} ( {{ calculateCompanyAge(quickInfoData['companyRegistrationDate']) }} years old )</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['active_directors_count']">
            <i class="ui-icon-font-download mr-2"></i>
            <span>No. of Active Directors: {{ quickInfoData['active_directors_count'] }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['sicCode']">
            <i class="ui-icon-cloud-done mr-2"></i>
            <span>
                SIC Code:
                <ng-container *ngFor="let item of getSICCodeInArrayFormat(quickInfoData['sicCode'])">
                    <div>{{ item }}</div>
                </ng-container>
            </span>
        </div> 
        <div class="popoverListItem" *ngIf="quickInfoData.NumMortCharges > 0">
            <i class="ui-icon-perm-contact-calendar mr-2"></i>
            <span>Mortgages: {{ quickInfoData.NumMortCharges }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData?.accountsMadeUpDate">
            <i class="pi pi-chart-bar mr-2"></i>
            <span>Last Financial Update: {{ quickInfoData?.accountsMadeUpDate }}</span>
        </div>
        
        <div class="popoverListItem" *ngIf="quickInfoData?.turnover">
            <!-- <i class="pi pi-euro mr-2"></i> -->
            <span>Turnover: &pound;{{ quickInfoData?.turnover | number }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData?.estimated_turnover">
            <span>Estimated Turnover: &pound;{{ quickInfoData?.estimated_turnover | number }}</span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData?.risk">
            <!-- <i class="pi pi-chart-bar mr-2"></i> -->
            <span>Risk Band: <span class="riskRatingLabel d-inline" [ngClass]="{'lightGreen' : quickInfoData?.risk == 'very low risk', 'cyan' : quickInfoData?.risk == 'low risk', 'yellow' : quickInfoData?.risk == 'moderate risk', 'orange' : quickInfoData?.risk == 'high risk', 'darkRed': quickInfoData?.risk == 'not scored' }">
                {{ ( quickInfoData?.risk ? quickInfoData?.risk == 'not scored'? 'Not Scored /Very High Risk': quickInfoData?.risk : '-' ) | titlecase }}
            </span></span>
        </div>
    </ng-container>
    <ng-template #other>
        
        <div class="p-mb-2">
            <h4 class="p-mt-0 p-mb-1">
                <strong> Additional Details </strong>
            </h4>
        </div>
        <hr>
        <div class="popoverListItem p-mb-3" *ngIf="quickInfoData['cbiladdress']">
            <i class="ui-icon-home p-mr-2"></i>
            <span><strong>Address:</strong> {{ quickInfoData['cbiladdress'] }} </span>
        </div>
        <div class="popoverListItem">
            <i class="ui-icon-font-download p-mr-2"></i>
            <span><strong>No. of Directors:</strong> {{ quickInfoData['totalDirectorsCount'] ? quickInfoData['totalDirectorsCount'] : 0 }} </span>
        </div>
        <div class="popoverListItem">
            <i class="ui-icon-supervisor-account p-mr-2"></i>
            <span><strong>No. of Shareholders:</strong> {{ quickInfoData['noOfShareHolders'] ? quickInfoData['noOfShareHolders'] : 0 }} </span>
        </div>
        <div class="popoverListItem p-mb-3">
            <i class="material-icons p-mr-2">map</i>
            <span><strong>No.of Corp. Land:</strong> {{ quickInfoData['noOfLandCorp'] ? quickInfoData['noOfLandCorp'] : 0 }} </span>
        </div>
        <div class="popoverListItem" *ngIf="quickInfoData['turnover'] || quickInfoData['turnover'] == 0">
            <i class="ui-icon-assessment p-mr-2"></i>
            <span><strong>Turnover:</strong> {{ quickInfoData['turnover'] }} </span>
        </div>
        <div class="popoverListItem">
            <i class="ui-icon-assessment p-mr-2"></i>
            <span><strong>Total Equity:</strong> {{ quickInfoData['totalShareholdersEquity'] ? quickInfoData['totalShareholdersEquity'] : 0 }} </span>
        </div>
        <div class="popoverListItem p-mb-3">
            <i class="ui-icon-assessment p-mr-2"></i>
            <span><strong>Net Worth:</strong> {{ quickInfoData['netWorth'] ? quickInfoData['netWorth'] : 0 }} </span>
        </div>
        <div class="popoverListItem">
            <i class="material-icons p-mr-2">gavel</i>
            <span><strong>No. of CCJ:</strong> {{ quickInfoData['noOfCcj'] ? quickInfoData['noOfCcj'] : 0 }} </span>
        </div>
        <div class="popoverListItem">
            <i class="material-icons p-mr-2">account_balance</i>
            <span><strong>No. of Charges:</strong> {{ quickInfoData['noOfCharges'] ? quickInfoData['noOfCharges'] : 0 }} </span>
        </div>
    </ng-template>
</div>
<!-- Company Quick Info Block for Bussiness Watch -->

<ng-container *ngIf="![ 'user-management', 'update-user', 'corporateRiskPage', 'investorFinderPage', 'investeeFinderPage', 'hnwiPage', 'supplierDashboard', 'buyersDashboard', 'nonRegCompanyPage', 'supplierNonRegPage', 'buyerNonRegPage', 'suppliersDashboard', 'supplierDashboard','contractFinderPage', 'esgWatchPage', 'showContactScreen', 'diversityInclusion', 'diversityCalculation', 'overviewLinkedinProfile', 'promptSearchAi', 'supplierResilience' ].includes( thisPage )">

    <div class="p-grid">
        <div class="p-col-12">
            <div class="p-p-3 p-p-md-0">
                <sup>*</sup> The Corporate Telephone Preference Service (CTPS) is the central opt-out register for organisations wishing to opt out from receiving sales and marketing calls.
            </div>
            <div class="p-p-3 p-p-md-0">
                <sup>*</sup> In general, you must not make marketing calls to any number listed on the Telephone Preference Service (TPS) or Corporate TPS (CTPS), unless that person has specifically consented to your calls. You can call a number if it is not listed on the TPS or CTPS and you are not marketing claims management services.
            </div>
        </div>
    </div>

</ng-container>

<ng-container *ngIf="[ 'showDirectorScreenPage', 'investorFinderPage' ].includes( thisPage )">

    <p-dialog header="{{ thisPage == 'investeeFinderPage' ? 'View Shareholders' : 'View Shareholdings' }}" [draggable]="false" [modal]="true" [(visible)]="viewShareholdings" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{ width: '75vw', 'overflow-y': 'auto' }">

        <dg-user-list [listColumns]="shareholderNShareholdingDetailsSummaryColumns" [listDataValues]="shareholderNShareholdingDetailsSummaryData" [listPage]="true" [thisPage]="thisPage == 'directorDetails'" *ngIf="shareholderNShareholdingDetailsSummaryData" [tableName]="'investorFinderPage'"></dg-user-list>

    </p-dialog>

</ng-container>

<ng-container *ngIf="[ 'investeeFinderPage' ].includes( thisPage )">

    <p-dialog header="View Shareholders" [draggable]="false" [modal]="true" [(visible)]="viewShareholdings" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{ width: '75vw', 'overflow-y': 'auto' }">

        <dg-user-list [listColumns]="shareholderNShareholdingDetailsSummaryColumns" [listDataValues]="shareholderNShareholdingDetailsSummaryData" [listPage]="true" [thisPage]="thisPage == 'investeeFinderPage'" *ngIf="shareholderNShareholdingDetailsSummaryData" [tableName]="'investeeFinderPage'" [pageName]="'investeeFinderPage'" [cmnyNumberForStats]="cmnyNumberForStats" ></dg-user-list>

    </p-dialog>

</ng-container>

<ng-container *ngIf="[ 'hnwiPage' ].includes( thisPage )">

    <p-dialog header="View Shareholdings" [draggable]="false" [modal]="true" [(visible)]="viewShareholdings" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{ width: '90vw', 'overflow-y': 'auto' }">

        <dg-user-list [listColumns]="hnwiShareholdingDetailsSummaryColumns" [listDataValues]="hnwiShareholdingDetailsSummaryData" [listPage]="true" [thisPage]="'hnwiPage'" *ngIf="hnwiShareholdingDetailsSummaryData" [shareHoldingLiveCount]="shareHoldingLiveCount" [shareHoldingDissolvedCount]="shareHoldingDissolvedCount" [cmnyNumberForStats]="cmnyNumberForStats" [pageName]="'hnwiPage'"></dg-user-list>

    </p-dialog>

</ng-container>

<ng-container *ngIf="[ 'contractFinderPage' ].includes( thisPage )">

    <p-dialog header="Suppliers" [draggable]="false" [modal]="true" [(visible)]="viewSuppliersTable" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{ width: '90vw', 'overflow-y': 'auto' }">

        <dg-user-list [listDataValues]="contractFinderSuppliersDataValues" [listColumns]="contractFinderSupplierColumns" [listPage]="true" [thisPage]="'contactFinderSuppliersPage'" *ngIf="contractFinderSuppliersDataValues"></dg-user-list>
     
    </p-dialog>

</ng-container>
<ng-template #noRegionArray>-</ng-template>
<ng-template #showZeroBlock>0</ng-template>

<p-dialog styleClass="subscriptionPlanDialogModal" [modal]="true" [(visible)]="confermDilogBox" [baseZIndex]="999999998" appendTo="body" [focusOnShow]="false" [style]="{width: '60vw'}">
    <dg-user-list [listColumns]="dataProviderInfoColumns" [listDataValues]="dataProviderInfo" [listPage]="true" [thisPage]="'personContactInfo'">
    </dg-user-list>
</p-dialog>