<!-- <ng-container *ngIf="userAuthService.hasAddOnPermission('developerFeatures')">
    <div class="p-3 m-1">
        <button pButton label="Classic Report" (click)="view = 'old-report'"></button>
        <button pButton label="New Report" class="ml-2" (click)="view = 'new-report'"></button>
    </div>
</ng-container> -->

<div class="flex m-1 py-1 mt-0" *ngIf="userAuthService.hasAddOnPermission('developerFeatures')">
    <div class="bg-gray-200 py-1 flex border-round-lg gap-1 border-1 border-gray-400">
        <div class="cursor-pointer hover:bg-teal-300 text-sm mx-1 px-3 py-1 border-round-lg {{ view == 'old-report' ? 'bg-teal-200 font-medium' : 'bg-gray-300'}} " (click)="view = 'old-report'">Classic Report</div>
        <div class="cursor-pointer hover:bg-teal-300 text-sm mx-1 px-3 py-1 border-round-lg {{ view == 'new-report' ? 'bg-teal-200  font-medium' : 'bg-gray-300'}} " (click)="view = 'new-report'">New Report</div>
    </div>
</div>

<div *ngIf="view == 'old-report'" class="card">
    <p-messages [value]="msgs"></p-messages>
    <div class="mb-6 p-4 border-green-600 border-round-md bg-cyan-50">

        <p-pickList  [source]="diversitySaveList || []" [target]="targetProducts || []" sourceHeader="Available" targetHeader="Selected" [dragdrop]="true" [responsive]="true" [sourceStyle]="{ height: '20rem' }" [targetStyle]="{ height: '20rem' }" breakpoint="1400px" (onMoveToTarget)="moveToTarget( $event )">
            <ng-template let-product pTemplate="item">
                <div class="flex flex-wrap p-1 align-items-center gap-3">{{ product.listName }}
                </div>
            </ng-template>
        </p-pickList>
        
        <div class="mt-3 text-center">
            <button pButton pRipple type="button" class="mt-3 w-10rem inline-block" label="Submit" [disabled]="!targetProducts.length" (click)="dataFetchFromApi()"></button>
        </div>
    </div>

    <div class="text-right" *ngIf="snapShotBoolean">
        <button pButton type="button" label="Take Snapshot" icon="pi pi-image" class="p-button-rounded p-button-sm mr-3" title="Take Snapshot" (click)="takeSnapshot(progressreportScreenDataId)"></button>
    </div>

    <div #progressreportScreenDataId class="grid">
        <div class="col-12">
            <div class="grid">
                <ng-container *ngFor="let item of displayHeaderCardArray">
                    <div *ngIf="item?.chartData?.labels.length" class="col-4">
                        <div class="border-1 border-200 py-3 border-round-sm">
                            <div class="text-lg mx-2 mb-2 font-semibold p-2 border-round-sm text-{{ item.styleClass }}-800 bg-{{ item.styleClass }}-100">{{ item.header }}</div>
                            <div>
                                <p-chart type="{{item.chartType}}" [data]="item.chartData" [options]="item.chartOptions" height="260px" [plugins]="item.plugin"></p-chart>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
        <div class="col-12" *ngIf="displayBarChartArray.length">
            <p-accordion [activeIndex]="0">
                <p-accordionTab header="Segmentation By Ownership">
                    <div class="grid">
                        <ng-container *ngFor="let item of displayBarChartArray">
                            <div class="col-4" [class.hidden]="[ 'isBcorpCertification', 'isNetZeroTarget', 'isPpcCategory', 'isVcseCategory'].includes(item.field) ">
                                <div *ngIf="item[ 'barData' ][ 'labels' ].length">
                                    <div class="p-2 mx-3 mt-2 bg-{{ item.styleClass }}-50 border-round-sm flex align-items-center justify-content-between">
                                        <div class="pl-1 mr-2 text-lg font-light text-{{ item.styleClass }}-500">{{ item?.displayLabel }}</div>
                                        <div class="text-2xl font-bold text-{{ item.styleClass }}-600 p-1">{{ item?.totalCount | currency: 'GBP' : 'symbol' : '1.0-0' }}</div>
                                    </div>
                                    <div>
                                        <p-chart type="bar" [data]="item.barData" [options]="barOptions" height="340px" [plugins]="ChartDataPlugins"></p-chart>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </p-accordionTab>
            </p-accordion>
        </div>
        <div class="col-12" *ngIf="displayBarChartArray.length">
            <p-accordion [activeIndex]="0">
                <p-accordionTab header="Mission Spectrum">
                    <div class="grid">
                        <ng-container *ngFor="let item of displayBarChartArray">
                            <div class="col-4" [class.hidden]="![ 'isBcorpCertification', 'isNetZeroTarget', 'isPpcCategory', 'isVcseCategory'].includes(item.field) ">
                                <div *ngIf="item[ 'barData' ][ 'labels' ].length">
                                    <div class="p-2 mx-3 mt-2 bg-{{ item.styleClass }}-50 border-round-sm flex align-items-center justify-content-between">
                                        <div class="pl-1 mr-2 text-lg font-light text-{{ item.styleClass }}-500">{{ item?.displayLabel }}</div>
                                        <div class="text-2xl font-bold text-{{ item.styleClass }}-600 p-1">{{ item?.totalCount | currency: 'GBP' : 'symbol' : '1.0-0' }}</div>
                                    </div>
                                    <div>
                                        <p-chart type="bar" [data]="item.barData" [options]="barOptions" height="340px" [plugins]="ChartDataPlugins"></p-chart>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </p-accordionTab>
            </p-accordion>
        </div>
    </div>
</div>
<ng-container *ngIf="view == 'new-report'">
    <dg-spend-report-analysis [dataFromApi]="diversityDataForNewReport"></dg-spend-report-analysis>
</ng-container>
